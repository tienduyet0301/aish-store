{
    "sourceFile": "src/app/profile/page.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1746959446519,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1746959483100,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,125 +1,1 @@\n-\"use client\";\r\n-\r\n-import { useState, useEffect } from \"react\";\r\n-import { useSession } from \"next-auth/react\";\r\n-import { useRouter } from \"next/navigation\";\r\n-\r\n-interface UserProfile {\r\n-  name: string;\r\n-  email: string;\r\n-  phone?: string;\r\n-  address?: string;\r\n-}\r\n-\r\n-export default function ProfilePage() {\r\n-  const { data: session, status } = useSession();\r\n-  const router = useRouter();\r\n-  const [profile, setProfile] = useState<UserProfile>({\r\n-    name: \"\",\r\n-    email: \"\",\r\n-    phone: \"\",\r\n-    address: \"\",\r\n-  });\r\n-  const [message, setMessage] = useState(\"\");\r\n-\r\n-  useEffect(() => {\r\n-    if (status === \"unauthenticated\") {\r\n-      router.push(\"/login\");\r\n-    } else if (session?.user?.email) {\r\n-      // Lấy thông tin profile từ database\r\n-      fetch(\"/api/user/profile\")\r\n-        .then((res) => res.json())\r\n-        .then((data) => {\r\n-          if (data) {\r\n-            setProfile({\r\n-              name: data.name || \"\",\r\n-              email: data.email || \"\",\r\n-              phone: data.phone || \"\",\r\n-              address: data.address || \"\",\r\n-            });\r\n-          }\r\n-        })\r\n-        .catch((error) => console.error(\"Error fetching profile:\", error));\r\n-    }\r\n-  }, [session, status]);\r\n-\r\n-  const handleSubmit = async (e: React.FormEvent) => {\r\n-    e.preventDefault();\r\n-    try {\r\n-      const response = await fetch(\"/api/user/profile\", {\r\n-        method: \"PUT\",\r\n-        headers: {\r\n-          \"Content-Type\": \"application/json\",\r\n-        },\r\n-        body: JSON.stringify(profile),\r\n-      });\r\n-\r\n-      if (response.ok) {\r\n-        setMessage(\"Thông tin đã được cập nhật thành công\");\r\n-      } else {\r\n-        setMessage(\"Có lỗi xảy ra khi cập nhật thông tin\");\r\n-      }\r\n-    } catch (error) {\r\n-      setMessage(\"Có lỗi xảy ra khi cập nhật thông tin\");\r\n-    }\r\n-  };\r\n-\r\n-  if (status === \"loading\") {\r\n-    return <div>Loading...</div>;\r\n-  }\r\n-\r\n-  return (\r\n-    <div className=\"mt-20 p-6 max-w-2xl mx-auto\">\r\n-      <h1 className=\"text-2xl font-bold mb-6 text-black\">Thông tin tài khoản</h1>\r\n-      {message && (\r\n-        <div className=\"mb-4 p-4 bg-green-100 text-green-700 rounded\">\r\n-          {message}\r\n-        </div>\r\n-      )}\r\n-      <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n-        <div>\r\n-          <label className=\"block text-sm font-medium text-gray-700\">Họ tên</label>\r\n-          <input\r\n-            type=\"text\"\r\n-            value={profile.name}\r\n-            onChange={(e) => setProfile({ ...profile, name: e.target.value })}\r\n-            className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\"\r\n-          />\r\n-        </div>\r\n-        <div>\r\n-          <label className=\"block text-sm font-medium text-gray-700\">Email</label>\r\n-          <input\r\n-            type=\"email\"\r\n-            value={profile.email}\r\n-            disabled\r\n-            className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm bg-gray-100\"\r\n-          />\r\n-        </div>\r\n-        <div>\r\n-          <label className=\"block text-sm font-medium text-gray-700\">Số điện thoại</label>\r\n-          <input\r\n-            type=\"tel\"\r\n-            value={profile.phone}\r\n-            onChange={(e) => setProfile({ ...profile, phone: e.target.value })}\r\n-            className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\"\r\n-          />\r\n-        </div>\r\n-        <div>\r\n-          <label className=\"block text-sm font-medium text-gray-700\">Địa chỉ</label>\r\n-          <textarea\r\n-            value={profile.address}\r\n-            onChange={(e) => setProfile({ ...profile, address: e.target.value })}\r\n-            className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\"\r\n-            rows={3}\r\n-          />\r\n-        </div>\r\n-        <button\r\n-          type=\"submit\"\r\n-          className=\"w-full bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600\"\r\n-        >\r\n-          Cập nhật thông tin\r\n-        </button>\r\n-      </form>\r\n-    </div>\r\n-  );\r\n-} \n\\ No newline at end of file\n+ \n\\ No newline at end of file\n"
                }
            ],
            "date": 1746959446519,
            "name": "Commit-0",
            "content": "\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { useSession } from \"next-auth/react\";\r\nimport { useRouter } from \"next/navigation\";\r\n\r\ninterface UserProfile {\r\n  name: string;\r\n  email: string;\r\n  phone?: string;\r\n  address?: string;\r\n}\r\n\r\nexport default function ProfilePage() {\r\n  const { data: session, status } = useSession();\r\n  const router = useRouter();\r\n  const [profile, setProfile] = useState<UserProfile>({\r\n    name: \"\",\r\n    email: \"\",\r\n    phone: \"\",\r\n    address: \"\",\r\n  });\r\n  const [message, setMessage] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    if (status === \"unauthenticated\") {\r\n      router.push(\"/login\");\r\n    } else if (session?.user?.email) {\r\n      // Lấy thông tin profile từ database\r\n      fetch(\"/api/user/profile\")\r\n        .then((res) => res.json())\r\n        .then((data) => {\r\n          if (data) {\r\n            setProfile({\r\n              name: data.name || \"\",\r\n              email: data.email || \"\",\r\n              phone: data.phone || \"\",\r\n              address: data.address || \"\",\r\n            });\r\n          }\r\n        })\r\n        .catch((error) => console.error(\"Error fetching profile:\", error));\r\n    }\r\n  }, [session, status]);\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    try {\r\n      const response = await fetch(\"/api/user/profile\", {\r\n        method: \"PUT\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(profile),\r\n      });\r\n\r\n      if (response.ok) {\r\n        setMessage(\"Thông tin đã được cập nhật thành công\");\r\n      } else {\r\n        setMessage(\"Có lỗi xảy ra khi cập nhật thông tin\");\r\n      }\r\n    } catch (error) {\r\n      setMessage(\"Có lỗi xảy ra khi cập nhật thông tin\");\r\n    }\r\n  };\r\n\r\n  if (status === \"loading\") {\r\n    return <div>Loading...</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"mt-20 p-6 max-w-2xl mx-auto\">\r\n      <h1 className=\"text-2xl font-bold mb-6 text-black\">Thông tin tài khoản</h1>\r\n      {message && (\r\n        <div className=\"mb-4 p-4 bg-green-100 text-green-700 rounded\">\r\n          {message}\r\n        </div>\r\n      )}\r\n      <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700\">Họ tên</label>\r\n          <input\r\n            type=\"text\"\r\n            value={profile.name}\r\n            onChange={(e) => setProfile({ ...profile, name: e.target.value })}\r\n            className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\"\r\n          />\r\n        </div>\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700\">Email</label>\r\n          <input\r\n            type=\"email\"\r\n            value={profile.email}\r\n            disabled\r\n            className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm bg-gray-100\"\r\n          />\r\n        </div>\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700\">Số điện thoại</label>\r\n          <input\r\n            type=\"tel\"\r\n            value={profile.phone}\r\n            onChange={(e) => setProfile({ ...profile, phone: e.target.value })}\r\n            className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\"\r\n          />\r\n        </div>\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700\">Địa chỉ</label>\r\n          <textarea\r\n            value={profile.address}\r\n            onChange={(e) => setProfile({ ...profile, address: e.target.value })}\r\n            className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\"\r\n            rows={3}\r\n          />\r\n        </div>\r\n        <button\r\n          type=\"submit\"\r\n          className=\"w-full bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600\"\r\n        >\r\n          Cập nhật thông tin\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n} "
        }
    ]
}