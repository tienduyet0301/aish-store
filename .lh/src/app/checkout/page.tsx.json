{
    "sourceFile": "src/app/checkout/page.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 4,
            "patches": [
                {
                    "date": 1747278146616,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1747288173979,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,4 +1,87 @@\n-export const metadata = {\r\n-  title: 'Checkout | AISH',\r\n-  description: 'Hoàn tất đơn hàng của bạn tại AISH. Thanh toán an toàn, giao hàng nhanh chóng và dịch vụ khách hàng tận tâm.',\r\n-}; \n\\ No newline at end of file\n+import React, { useState } from \"react\";\r\n+\r\n+const [discountCode, setDiscountCode] = useState(\"\");\r\n+const [discountError, setDiscountError] = useState(\"\");\r\n+const [discountSuccess, setDiscountSuccess] = useState(\"\");\r\n+const [appliedDiscount, setAppliedDiscount] = useState<{\r\n+  code: string;\r\n+  amount: number;\r\n+} | null>(null);\r\n+\r\n+const handleApplyDiscount = async () => {\r\n+  if (!discountCode.trim()) {\r\n+    setDiscountError(\"Vui lòng nhập mã giảm giá\");\r\n+    setDiscountSuccess(\"\");\r\n+    return;\r\n+  }\r\n+\r\n+  try {\r\n+    const response = await fetch(\"/api/discount/validate\", {\r\n+      method: \"POST\",\r\n+      headers: {\r\n+        \"Content-Type\": \"application/json\",\r\n+      },\r\n+      body: JSON.stringify({ code: discountCode }),\r\n+    });\r\n+\r\n+    const data = await response.json();\r\n+\r\n+    if (!response.ok) {\r\n+      setDiscountError(data.message || \"Mã giảm giá không hợp lệ\");\r\n+      setDiscountSuccess(\"\");\r\n+      setAppliedDiscount(null);\r\n+      return;\r\n+    }\r\n+\r\n+    if (data.isExpired) {\r\n+      setDiscountError(\"Mã giảm giá đã hết hạn\");\r\n+      setDiscountSuccess(\"\");\r\n+      setAppliedDiscount(null);\r\n+      return;\r\n+    }\r\n+\r\n+    // Nếu mã hợp lệ và chưa hết hạn\r\n+    setDiscountSuccess(\"Áp dụng mã giảm giá thành công\");\r\n+    setDiscountError(\"\");\r\n+    setAppliedDiscount({\r\n+      code: discountCode,\r\n+      amount: data.discountAmount,\r\n+    });\r\n+    setDiscountCode(\"\"); // Xóa mã sau khi áp dụng thành công\r\n+  } catch (error) {\r\n+    setDiscountError(\"Có lỗi xảy ra khi kiểm tra mã giảm giá\");\r\n+    setDiscountSuccess(\"\");\r\n+    setAppliedDiscount(null);\r\n+  }\r\n+};\r\n+\r\n+{/* Discount Code Section */}\r\n+<div className=\"mt-6\">\r\n+  <div className=\"flex items-center gap-2\">\r\n+    <input\r\n+      type=\"text\"\r\n+      value={discountCode}\r\n+      onChange={(e) => setDiscountCode(e.target.value)}\r\n+      placeholder=\"Nhập mã giảm giá\"\r\n+      className=\"flex-1 px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-black\"\r\n+    />\r\n+    <button\r\n+      onClick={handleApplyDiscount}\r\n+      className=\"px-4 py-2 bg-black text-white rounded-md hover:bg-gray-800 transition-colors\"\r\n+    >\r\n+      Áp dụng\r\n+    </button>\r\n+  </div>\r\n+  {discountError && (\r\n+    <p className=\"mt-2 text-sm text-red-500\">{discountError}</p>\r\n+  )}\r\n+  {discountSuccess && (\r\n+    <p className=\"mt-2 text-sm text-green-500\">{discountSuccess}</p>\r\n+  )}\r\n+  {appliedDiscount && (\r\n+    <div className=\"mt-2 flex items-center justify-between text-sm\">\r\n+      <span className=\"text-gray-600\">Mã giảm giá: {appliedDiscount.code}</span>\r\n+      <span className=\"text-green-500\">-{formatPrice(appliedDiscount.amount)}</span>\r\n+    </div>\r\n+  )}\r\n+</div> \n\\ No newline at end of file\n"
                },
                {
                    "date": 1747288195450,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,87 +1,1 @@\n-import React, { useState } from \"react\";\r\n-\r\n-const [discountCode, setDiscountCode] = useState(\"\");\r\n-const [discountError, setDiscountError] = useState(\"\");\r\n-const [discountSuccess, setDiscountSuccess] = useState(\"\");\r\n-const [appliedDiscount, setAppliedDiscount] = useState<{\r\n-  code: string;\r\n-  amount: number;\r\n-} | null>(null);\r\n-\r\n-const handleApplyDiscount = async () => {\r\n-  if (!discountCode.trim()) {\r\n-    setDiscountError(\"Vui lòng nhập mã giảm giá\");\r\n-    setDiscountSuccess(\"\");\r\n-    return;\r\n-  }\r\n-\r\n-  try {\r\n-    const response = await fetch(\"/api/discount/validate\", {\r\n-      method: \"POST\",\r\n-      headers: {\r\n-        \"Content-Type\": \"application/json\",\r\n-      },\r\n-      body: JSON.stringify({ code: discountCode }),\r\n-    });\r\n-\r\n-    const data = await response.json();\r\n-\r\n-    if (!response.ok) {\r\n-      setDiscountError(data.message || \"Mã giảm giá không hợp lệ\");\r\n-      setDiscountSuccess(\"\");\r\n-      setAppliedDiscount(null);\r\n-      return;\r\n-    }\r\n-\r\n-    if (data.isExpired) {\r\n-      setDiscountError(\"Mã giảm giá đã hết hạn\");\r\n-      setDiscountSuccess(\"\");\r\n-      setAppliedDiscount(null);\r\n-      return;\r\n-    }\r\n-\r\n-    // Nếu mã hợp lệ và chưa hết hạn\r\n-    setDiscountSuccess(\"Áp dụng mã giảm giá thành công\");\r\n-    setDiscountError(\"\");\r\n-    setAppliedDiscount({\r\n-      code: discountCode,\r\n-      amount: data.discountAmount,\r\n-    });\r\n-    setDiscountCode(\"\"); // Xóa mã sau khi áp dụng thành công\r\n-  } catch (error) {\r\n-    setDiscountError(\"Có lỗi xảy ra khi kiểm tra mã giảm giá\");\r\n-    setDiscountSuccess(\"\");\r\n-    setAppliedDiscount(null);\r\n-  }\r\n-};\r\n-\r\n-{/* Discount Code Section */}\r\n-<div className=\"mt-6\">\r\n-  <div className=\"flex items-center gap-2\">\r\n-    <input\r\n-      type=\"text\"\r\n-      value={discountCode}\r\n-      onChange={(e) => setDiscountCode(e.target.value)}\r\n-      placeholder=\"Nhập mã giảm giá\"\r\n-      className=\"flex-1 px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-black\"\r\n-    />\r\n-    <button\r\n-      onClick={handleApplyDiscount}\r\n-      className=\"px-4 py-2 bg-black text-white rounded-md hover:bg-gray-800 transition-colors\"\r\n-    >\r\n-      Áp dụng\r\n-    </button>\r\n-  </div>\r\n-  {discountError && (\r\n-    <p className=\"mt-2 text-sm text-red-500\">{discountError}</p>\r\n-  )}\r\n-  {discountSuccess && (\r\n-    <p className=\"mt-2 text-sm text-green-500\">{discountSuccess}</p>\r\n-  )}\r\n-  {appliedDiscount && (\r\n-    <div className=\"mt-2 flex items-center justify-between text-sm\">\r\n-      <span className=\"text-gray-600\">Mã giảm giá: {appliedDiscount.code}</span>\r\n-      <span className=\"text-green-500\">-{formatPrice(appliedDiscount.amount)}</span>\r\n-    </div>\r\n-  )}\r\n-</div> \n\\ No newline at end of file\n+ \n\\ No newline at end of file\n"
                },
                {
                    "date": 1747288238043,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,1 +1,46 @@\n- \n\\ No newline at end of file\n+const handleApplyDiscount = async () => {\r\n+  if (!discountCode.trim()) {\r\n+    setDiscountError(\"Vui lòng nhập mã giảm giá\");\r\n+    setDiscountSuccess(\"\");\r\n+    return;\r\n+  }\r\n+\r\n+  try {\r\n+    const response = await fetch(\"/api/discount/validate\", {\r\n+      method: \"POST\",\r\n+      headers: {\r\n+        \"Content-Type\": \"application/json\",\r\n+      },\r\n+      body: JSON.stringify({ code: discountCode }),\r\n+    });\r\n+\r\n+    const data = await response.json();\r\n+\r\n+    if (!response.ok) {\r\n+      setDiscountError(data.message || \"Mã giảm giá không hợp lệ\");\r\n+      setDiscountSuccess(\"\");\r\n+      setAppliedDiscount(null);\r\n+      return;\r\n+    }\r\n+\r\n+    if (data.isExpired) {\r\n+      setDiscountError(\"Mã giảm giá đã hết hạn\");\r\n+      setDiscountSuccess(\"\");\r\n+      setAppliedDiscount(null);\r\n+      return;\r\n+    }\r\n+\r\n+    // Nếu mã hợp lệ và chưa hết hạn\r\n+    setDiscountSuccess(\"Áp dụng mã giảm giá thành công\");\r\n+    setDiscountError(\"\");\r\n+    setAppliedDiscount({\r\n+      code: discountCode,\r\n+      amount: data.discountAmount,\r\n+    });\r\n+    // Không xóa mã sau khi áp dụng thành công\r\n+  } catch (error) {\r\n+    setDiscountError(\"Có lỗi xảy ra khi kiểm tra mã giảm giá\");\r\n+    setDiscountSuccess(\"\");\r\n+    setAppliedDiscount(null);\r\n+  }\r\n+}; \n\\ No newline at end of file\n"
                },
                {
                    "date": 1747288261142,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,46 +1,1 @@\n-const handleApplyDiscount = async () => {\r\n-  if (!discountCode.trim()) {\r\n-    setDiscountError(\"Vui lòng nhập mã giảm giá\");\r\n-    setDiscountSuccess(\"\");\r\n-    return;\r\n-  }\r\n-\r\n-  try {\r\n-    const response = await fetch(\"/api/discount/validate\", {\r\n-      method: \"POST\",\r\n-      headers: {\r\n-        \"Content-Type\": \"application/json\",\r\n-      },\r\n-      body: JSON.stringify({ code: discountCode }),\r\n-    });\r\n-\r\n-    const data = await response.json();\r\n-\r\n-    if (!response.ok) {\r\n-      setDiscountError(data.message || \"Mã giảm giá không hợp lệ\");\r\n-      setDiscountSuccess(\"\");\r\n-      setAppliedDiscount(null);\r\n-      return;\r\n-    }\r\n-\r\n-    if (data.isExpired) {\r\n-      setDiscountError(\"Mã giảm giá đã hết hạn\");\r\n-      setDiscountSuccess(\"\");\r\n-      setAppliedDiscount(null);\r\n-      return;\r\n-    }\r\n-\r\n-    // Nếu mã hợp lệ và chưa hết hạn\r\n-    setDiscountSuccess(\"Áp dụng mã giảm giá thành công\");\r\n-    setDiscountError(\"\");\r\n-    setAppliedDiscount({\r\n-      code: discountCode,\r\n-      amount: data.discountAmount,\r\n-    });\r\n-    // Không xóa mã sau khi áp dụng thành công\r\n-  } catch (error) {\r\n-    setDiscountError(\"Có lỗi xảy ra khi kiểm tra mã giảm giá\");\r\n-    setDiscountSuccess(\"\");\r\n-    setAppliedDiscount(null);\r\n-  }\r\n-}; \n\\ No newline at end of file\n+ \n\\ No newline at end of file\n"
                }
            ],
            "date": 1747278146616,
            "name": "Commit-0",
            "content": "export const metadata = {\r\n  title: 'Checkout | AISH',\r\n  description: 'Hoàn tất đơn hàng của bạn tại AISH. Thanh toán an toàn, giao hàng nhanh chóng và dịch vụ khách hàng tận tâm.',\r\n}; "
        }
    ]
}