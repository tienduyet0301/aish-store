{
    "sourceFile": "src/app/checkout/summary/page.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 13,
            "patches": [
                {
                    "date": 1746893162592,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1746901799895,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,146 +1,277 @@\n+\"use client\";\r\n+import { useState, useEffect } from \"react\";\r\n+import { useCart } from \"../../../context/CartContext\";\r\n+\r\n export default function OrderSummary({ order }) {\r\n-    return (\r\n-      <div style={styles.rightSection}>\r\n-        <div style={styles.orderSummary}>\r\n-          <h2 style={{ ...styles.sectionTitle, textAlign: \"center\", borderBottom: \"1px solid #000000\", paddingBottom: \"10px\" }}>\r\n-            ORDER SUMMARY\r\n-          </h2>\r\n-          {order.items.map((item, index) => (\r\n-            <div key={index} style={styles.orderItem}>\r\n-              <img src={item.image} alt={item.name} style={styles.orderImage} />\r\n-              <div style={styles.orderItemDetails}>\r\n-                <p style={{ fontWeight: \"bold\", marginBottom: \"8px\", fontSize: \"0.95em\" }}>{item.name}</p>\r\n-                <div style={styles.orderDetailRow}>\r\n-                  <span>Số lượng:</span>\r\n-                  <span>{item.quantity}</span>\r\n-                </div>\r\n-                <div style={styles.orderDetailRow}>\r\n-                  <span>Màu:</span>\r\n-                  <span>{item.color}</span>\r\n-                </div>\r\n-                <div style={styles.orderDetailRow}>\r\n-                  <span>Size:</span>\r\n-                  <span>{item.size}</span>\r\n-                </div>\r\n-                <div style={styles.orderDetailRow}>\r\n-                  <span>Thời gian:</span>\r\n-                  <span>Dự kiến 5 ngày</span>\r\n-                </div>\r\n-                <div style={styles.orderDetailRow}>\r\n-                  <span>Giá:</span>\r\n-                  <span>{item.price}</span>\r\n-                </div>\r\n+  const { cartItems } = useCart();\r\n+  const [isMounted, setIsMounted] = useState(false);\r\n+  const [isPromoApplied, setIsPromoApplied] = useState(false);\r\n+  const [promoAmount, setPromoAmount] = useState(0);\r\n+  const [promoCode, setPromoCode] = useState(\"\");\r\n+  const [promoMessage, setPromoMessage] = useState(\"\");\r\n+\r\n+  useEffect(() => {\r\n+    setIsMounted(true);\r\n+  }, []);\r\n+\r\n+  const handleApplyPromoCode = async () => {\r\n+    setPromoMessage(\"\");\r\n+    setPromoAmount(0);\r\n+    setIsPromoApplied(false);\r\n+\r\n+    if (!promoCode.trim()) {\r\n+      setPromoMessage(\"Vui lòng nhập mã giảm giá\");\r\n+      return;\r\n+    }\r\n+\r\n+    try {\r\n+      const response = await fetch(\"/api/admin/notifications\");\r\n+      const data = await response.json();\r\n+      \r\n+      if (data.ok && data.promoCodes) {\r\n+        const foundPromo = data.promoCodes.find(\r\n+          promo => promo.code.toLowerCase() === promoCode.toLowerCase() && promo.isActive\r\n+        );\r\n+        \r\n+        if (foundPromo) {\r\n+          setPromoAmount(foundPromo.amount);\r\n+          setIsPromoApplied(true);\r\n+          setPromoMessage(`Mã giảm giá ${foundPromo.amount.toLocaleString('vi-VN')} VND đã được áp dụng!`);\r\n+        } else {\r\n+          setPromoMessage(\"Mã giảm giá không hợp lệ hoặc đã hết hạn\");\r\n+          setPromoAmount(0);\r\n+          setIsPromoApplied(false);\r\n+        }\r\n+      } else {\r\n+        setPromoMessage(\"Không thể kiểm tra mã giảm giá\");\r\n+        setPromoAmount(0);\r\n+        setIsPromoApplied(false);\r\n+      }\r\n+    } catch (error) {\r\n+      console.error(\"Error applying promo code:\", error);\r\n+      setPromoMessage(\"Có lỗi xảy ra khi áp dụng mã giảm giá\");\r\n+      setPromoAmount(0);\r\n+      setIsPromoApplied(false);\r\n+    }\r\n+  };\r\n+\r\n+  const handleResetPromoCode = () => {\r\n+    setPromoCode(\"\");\r\n+    setPromoMessage(\"\");\r\n+    setPromoAmount(0);\r\n+    setIsPromoApplied(false);\r\n+  };\r\n+\r\n+  const calculateTotal = () => {\r\n+    const subtotal = cartItems\r\n+      .reduce((total, item) => {\r\n+        const itemTotal = item.price * item.quantity;\r\n+        return total + itemTotal;\r\n+      }, 0);\r\n+\r\n+    const finalTotal = subtotal - (isPromoApplied ? promoAmount : 0);\r\n+    \r\n+    return finalTotal.toLocaleString('vi-VN') + \" VND\";\r\n+  };\r\n+\r\n+  if (!isMounted) return null;\r\n+\r\n+  return (\r\n+    <div className=\"bg-white p-6 rounded-lg shadow-md sticky top-4\">\r\n+      <h2 style={{\r\n+        fontSize: \"1em\",\r\n+        fontWeight: \"bold\",\r\n+        marginBottom: \"15px\",\r\n+        color: \"#000000\",\r\n+        textAlign: \"left\",\r\n+        borderBottom: \"1px solid #000000\",\r\n+        paddingBottom: \"10px\"\r\n+      }}>\r\n+        ORDER SUMMARY\r\n+      </h2>\r\n+      <div className=\"space-y-4\">\r\n+        {cartItems.map((item) => (\r\n+          <div key={item.cartItemId || `${item.id}-${item.size}`} style={{\r\n+            display: \"flex\",\r\n+            gap: \"15px\",\r\n+            marginBottom: \"20px\",\r\n+            color: \"#000000\",\r\n+          }}>\r\n+            <img \r\n+              src={item.image} \r\n+              alt={item.name} \r\n+              style={{\r\n+                width: \"80px\",\r\n+                height: \"80px\",\r\n+                objectFit: \"cover\",\r\n+              }}\r\n+            />\r\n+            <div style={{\r\n+              color: \"#000000\",\r\n+              flex: 1,\r\n+            }}>\r\n+              <p style={{ \r\n+                fontWeight: \"bold\", \r\n+                marginBottom: \"6px\", \r\n\\ No newline at end of file\n+                fontSize: \"0.9em\" \r\n+              }}>\r\n+                {item.name}\r\n+              </p>\r\n+              <div style={{\r\n+                display: \"flex\",\r\n+                justifyContent: \"space-between\",\r\n+                marginBottom: \"4px\",\r\n+                fontSize: \"0.7em\",\r\n+                color: \"#000000\",\r\n+              }}>\r\n+                <span>Số lượng:</span>\r\n+                <span>{item.quantity}</span>\r\n               </div>\r\n+              <div style={{\r\n+                display: \"flex\",\r\n+                justifyContent: \"space-between\",\r\n+                marginBottom: \"4px\",\r\n+                fontSize: \"0.7em\",\r\n+                color: \"#000000\",\r\n+              }}>\r\n+                <span>Màu:</span>\r\n+                <span>{item.color || \"Đen\"}</span>\r\n+              </div>\r\n+              <div style={{\r\n+                display: \"flex\",\r\n+                justifyContent: \"space-between\",\r\n+                marginBottom: \"4px\",\r\n+                fontSize: \"0.7em\",\r\n+                color: \"#000000\",\r\n+              }}>\r\n+                <span>Size:</span>\r\n+                <span>{item.size || \"Unknown\"}</span>\r\n+              </div>\r\n+              <div style={{\r\n+                display: \"flex\",\r\n+                justifyContent: \"space-between\",\r\n+                marginBottom: \"4px\",\r\n+                fontSize: \"0.7em\",\r\n+                color: \"#000000\",\r\n+              }}>\r\n+                <span>Thời gian:</span>\r\n+                <span>{item.shippingInfo || \"Dự kiến 5 ngày\"}</span>\r\n+              </div>\r\n+              <div style={{\r\n+                display: \"flex\",\r\n+                justifyContent: \"space-between\",\r\n+                marginBottom: \"4px\",\r\n+                fontSize: \"0.7em\",\r\n+                color: \"#000000\",\r\n+              }}>\r\n+                <span>Giá:</span>\r\n+                <span>{(item.price * item.quantity).toLocaleString('vi-VN')} VND</span>\r\n+              </div>\r\n             </div>\r\n-          ))}\r\n-          <div style={styles.orderTotals}>\r\n-            <div style={styles.orderTotalRow}>\r\n-              <span>Tổng phụ</span>\r\n-              <span>{order.subtotal.replace('AU$', '').trim()} VND</span>\r\n-            </div>\r\n-            <div style={styles.orderTotalRow}>\r\n-              <span>Vận chuyển</span>\r\n-              <span>Miễn phí (Express)</span>\r\n-            </div>\r\n-            <div style={styles.orderTotalRow}>\r\n-              <span style={{ fontWeight: \"bold\" }}>Tổng cộng</span>\r\n-              <span style={{ fontWeight: \"bold\" }}>{order.total.replace('AU$', '').trim()} VND</span>\r\n-            </div>\r\n           </div>\r\n+        ))}\r\n+        \r\n+        <div style={{\r\n+          display: \"flex\",\r\n+          justifyContent: \"space-between\",\r\n+          marginBottom: \"8px\",\r\n+          fontSize: \"0.7em\",\r\n+          color: \"#000000\",\r\n+        }}>\r\n+          <span>Vận chuyển</span>\r\n+          <span>Miễn phí (Express)</span>\r\n         </div>\r\n-        <div style={{ ...styles.viewDetailsSection, borderTop: \"1px solid #000000\", paddingTop: \"10px\" }}>\r\n-          <div style={styles.viewDetails}>VIEW DETAILS</div>\r\n-          <div style={styles.billingNote}>\r\n-            Please note that your billing details will be verified and your credit card will be charged at the time of\r\n-            shipment. For Made to Order, DIY, personalised and selected Décor items, payment will be taken at the time the\r\n-            order is placed.\r\n+        {isPromoApplied && (\r\n+          <div style={{\r\n+            display: \"flex\",\r\n+            justifyContent: \"space-between\",\r\n+            marginBottom: \"8px\",\r\n+            fontSize: \"0.7em\",\r\n+            color: \"#000000\",\r\n+          }}>\r\n+            <span>Mã giảm giá</span>\r\n+            <span>- {promoAmount.toLocaleString('vi-VN')} VND</span>\r\n           </div>\r\n+        )}\r\n+        <div style={{\r\n+          display: \"flex\",\r\n+          justifyContent: \"space-between\",\r\n+          marginBottom: \"8px\",\r\n+          fontSize: \"0.7em\",\r\n+          fontWeight: \"bold\",\r\n+          color: \"#000000\",\r\n+        }}>\r\n+          <span>Tổng cộng</span>\r\n+          <span>{calculateTotal()}</span>\r\n         </div>\r\n-        <div style={{ ...styles.helpSection, borderTop: \"1px solid #000000\", borderBottom: \"1px solid #000000\", paddingTop: \"10px\", paddingBottom: \"10px\" }}>\r\n-          <p style={{ marginBottom: \"10px\", fontWeight: \"bold\" }}>MAY WE HELP?</p>\r\n-          <p style={{ marginBottom: \"10px\" }}>+61 1300492212</p>\r\n-          <p style={{ marginBottom: \"10px\" }}>clientservice.au@gucci.com</p>\r\n+      </div>\r\n+      <div style={{ \r\n+        borderTop: \"1px solid #000000\", \r\n+        paddingTop: \"10px\",\r\n+        marginTop: \"20px\"\r\n+      }}>\r\n+        <div style={{\r\n+          display: \"flex\",\r\n+          gap: \"10px\",\r\n+          marginBottom: \"15px\",\r\n+        }}>\r\n+          <input\r\n+            type=\"text\"\r\n+            value={promoCode}\r\n+            onChange={(e) => {\r\n+              setPromoCode(e.target.value);\r\n+              if (promoMessage) {\r\n+                setPromoMessage(\"\");\r\n+              }\r\n+            }}\r\n+            placeholder=\"Enter promo code\"\r\n+            style={{\r\n+              flex: 1,\r\n+              padding: \"8px\",\r\n+              fontSize: \"0.7em\",\r\n+              border: \"1px solid #000000\",\r\n+              color: \"#000000\",\r\n+            }}\r\n+          />\r\n+          <button\r\n+            onClick={handleApplyPromoCode}\r\n+            style={{\r\n+              padding: \"8px 15px\",\r\n+              fontSize: \"0.7em\",\r\n+              backgroundColor: \"#000000\",\r\n+              color: \"#ffffff\",\r\n+              border: \"none\",\r\n+              cursor: \"pointer\",\r\n+            }}\r\n+          >\r\n+            Apply\r\n+          </button>\r\n+          {isPromoApplied && (\r\n+            <button\r\n+              onClick={handleResetPromoCode}\r\n+              style={{\r\n+                padding: \"8px 15px\",\r\n+                fontSize: \"0.7em\",\r\n+                backgroundColor: \"#dc2626\",\r\n+                color: \"#ffffff\",\r\n+                border: \"none\",\r\n+                cursor: \"pointer\",\r\n+              }}\r\n+            >\r\n+              Reset\r\n+            </button>\r\n+          )}\r\n         </div>\r\n+        {promoMessage && (\r\n+          <p style={{\r\n+            fontSize: \"0.7em\",\r\n+            color: isPromoApplied ? \"#059669\" : \"#dc2626\",\r\n+            marginBottom: \"10px\"\r\n+          }}>\r\n+            {promoMessage}\r\n+          </p>\r\n+        )}\r\n       </div>\r\n-    );\r\n-  }\r\n-  \r\n-  const styles = {\r\n-    rightSection: {\r\n-      flex: 1,\r\n-      backgroundColor: \"#ffffff\",\r\n-      padding: \"15px\",\r\n-      border: \"1px solid #e0e0e0\",\r\n-      color: \"#000000\",\r\n-      display: \"flex\",\r\n-      flexDirection: \"column\",\r\n-      gap: \"20px\",\r\n-    },\r\n-    orderSummary: {\r\n-      color: \"#000000\",\r\n-    },\r\n-    sectionTitle: {\r\n-      fontSize: \"1.1em\",\r\n-      fontWeight: \"bold\",\r\n-      marginBottom: \"15px\",\r\n-      color: \"#000000\",\r\n-      display: \"flex\",\r\n-      alignItems: \"center\",\r\n-      gap: \"8px\",\r\n-    },\r\n-    orderItem: {\r\n-      display: \"flex\",\r\n-      gap: \"15px\",\r\n-      marginBottom: \"25px\",\r\n-      color: \"#000000\",\r\n-    },\r\n-    orderImage: {\r\n-      width: \"80px\",\r\n-      height: \"80px\",\r\n-      objectFit: \"cover\",\r\n-    },\r\n-    orderItemDetails: {\r\n-      color: \"#000000\",\r\n-      flex: 1,\r\n-    },\r\n-    orderDetailRow: {\r\n-      display: \"flex\",\r\n-      justifyContent: \"space-between\",\r\n-      marginBottom: \"8px\",\r\n-      fontSize: \"0.75em\",\r\n-    },\r\n-    orderTotals: {\r\n-      color: \"#000000\",\r\n-    },\r\n-    orderTotalRow: {\r\n-      display: \"flex\",\r\n-      justifyContent: \"space-between\",\r\n-      marginBottom: \"12px\",\r\n-    },\r\n-    viewDetailsSection: {\r\n-      color: \"#000000\",\r\n-    },\r\n-    viewDetails: {\r\n-      fontSize: \"0.8em\",\r\n-      marginTop: \"15px\",\r\n-      marginBottom: \"15px\",\r\n-      cursor: \"pointer\",\r\n-      textDecoration: \"underline\",\r\n-      color: \"#000000\",\r\n-    },\r\n-    billingNote: {\r\n-      fontSize: \"0.75em\",\r\n-      color: \"#000000\",\r\n-      marginTop: \"15px\",\r\n-      marginBottom: \"15px\",\r\n-    },\r\n-    helpSection: {\r\n-      fontSize: \"0.8em\",\r\n-      color: \"#000000\",\r\n-    },\r\n-    \"@media (maxWidth: 768px)\": {\r\n-      rightSection: {\r\n-        order: -1,\r\n-      },\r\n-    },\r\n-  };\n+    </div>\r\n+  );\r\n+}\n\\ No newline at end of file\n"
                },
                {
                    "date": 1746901831323,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,277 +1,146 @@\n-\"use client\";\r\n-import { useState, useEffect } from \"react\";\r\n-import { useCart } from \"../../../context/CartContext\";\r\n-\r\n export default function OrderSummary({ order }) {\r\n-  const { cartItems } = useCart();\r\n-  const [isMounted, setIsMounted] = useState(false);\r\n-  const [isPromoApplied, setIsPromoApplied] = useState(false);\r\n-  const [promoAmount, setPromoAmount] = useState(0);\r\n-  const [promoCode, setPromoCode] = useState(\"\");\r\n-  const [promoMessage, setPromoMessage] = useState(\"\");\r\n-\r\n-  useEffect(() => {\r\n-    setIsMounted(true);\r\n-  }, []);\r\n-\r\n-  const handleApplyPromoCode = async () => {\r\n-    setPromoMessage(\"\");\r\n-    setPromoAmount(0);\r\n-    setIsPromoApplied(false);\r\n-\r\n-    if (!promoCode.trim()) {\r\n-      setPromoMessage(\"Vui lòng nhập mã giảm giá\");\r\n-      return;\r\n-    }\r\n-\r\n-    try {\r\n-      const response = await fetch(\"/api/admin/notifications\");\r\n-      const data = await response.json();\r\n-      \r\n-      if (data.ok && data.promoCodes) {\r\n-        const foundPromo = data.promoCodes.find(\r\n-          promo => promo.code.toLowerCase() === promoCode.toLowerCase() && promo.isActive\r\n-        );\r\n-        \r\n-        if (foundPromo) {\r\n-          setPromoAmount(foundPromo.amount);\r\n-          setIsPromoApplied(true);\r\n-          setPromoMessage(`Mã giảm giá ${foundPromo.amount.toLocaleString('vi-VN')} VND đã được áp dụng!`);\r\n-        } else {\r\n-          setPromoMessage(\"Mã giảm giá không hợp lệ hoặc đã hết hạn\");\r\n-          setPromoAmount(0);\r\n-          setIsPromoApplied(false);\r\n-        }\r\n-      } else {\r\n-        setPromoMessage(\"Không thể kiểm tra mã giảm giá\");\r\n-        setPromoAmount(0);\r\n-        setIsPromoApplied(false);\r\n-      }\r\n-    } catch (error) {\r\n-      console.error(\"Error applying promo code:\", error);\r\n-      setPromoMessage(\"Có lỗi xảy ra khi áp dụng mã giảm giá\");\r\n-      setPromoAmount(0);\r\n-      setIsPromoApplied(false);\r\n-    }\r\n-  };\r\n-\r\n-  const handleResetPromoCode = () => {\r\n-    setPromoCode(\"\");\r\n-    setPromoMessage(\"\");\r\n-    setPromoAmount(0);\r\n-    setIsPromoApplied(false);\r\n-  };\r\n-\r\n-  const calculateTotal = () => {\r\n-    const subtotal = cartItems\r\n-      .reduce((total, item) => {\r\n-        const itemTotal = item.price * item.quantity;\r\n-        return total + itemTotal;\r\n-      }, 0);\r\n-\r\n-    const finalTotal = subtotal - (isPromoApplied ? promoAmount : 0);\r\n-    \r\n-    return finalTotal.toLocaleString('vi-VN') + \" VND\";\r\n-  };\r\n-\r\n-  if (!isMounted) return null;\r\n-\r\n-  return (\r\n-    <div className=\"bg-white p-6 rounded-lg shadow-md sticky top-4\">\r\n-      <h2 style={{\r\n-        fontSize: \"1em\",\r\n-        fontWeight: \"bold\",\r\n-        marginBottom: \"15px\",\r\n-        color: \"#000000\",\r\n-        textAlign: \"left\",\r\n-        borderBottom: \"1px solid #000000\",\r\n-        paddingBottom: \"10px\"\r\n-      }}>\r\n-        ORDER SUMMARY\r\n-      </h2>\r\n-      <div className=\"space-y-4\">\r\n-        {cartItems.map((item) => (\r\n-          <div key={item.cartItemId || `${item.id}-${item.size}`} style={{\r\n-            display: \"flex\",\r\n-            gap: \"15px\",\r\n-            marginBottom: \"20px\",\r\n-            color: \"#000000\",\r\n-          }}>\r\n-            <img \r\n-              src={item.image} \r\n-              alt={item.name} \r\n-              style={{\r\n-                width: \"80px\",\r\n-                height: \"80px\",\r\n-                objectFit: \"cover\",\r\n-              }}\r\n-            />\r\n-            <div style={{\r\n-              color: \"#000000\",\r\n-              flex: 1,\r\n-            }}>\r\n-              <p style={{ \r\n-                fontWeight: \"bold\", \r\n-                marginBottom: \"6px\", \r\n-                fontSize: \"0.9em\" \r\n-              }}>\r\n-                {item.name}\r\n-              </p>\r\n-              <div style={{\r\n-                display: \"flex\",\r\n-                justifyContent: \"space-between\",\r\n-                marginBottom: \"4px\",\r\n-                fontSize: \"0.7em\",\r\n-                color: \"#000000\",\r\n-              }}>\r\n-                <span>Số lượng:</span>\r\n-                <span>{item.quantity}</span>\r\n+    return (\r\n+      <div style={styles.rightSection}>\r\n+        <div style={styles.orderSummary}>\r\n+          <h2 style={{ ...styles.sectionTitle, textAlign: \"center\", borderBottom: \"1px solid #000000\", paddingBottom: \"10px\" }}>\r\n+            ORDER SUMMARY\r\n+          </h2>\r\n+          {order.items.map((item, index) => (\r\n+            <div key={index} style={styles.orderItem}>\r\n+              <img src={item.image} alt={item.name} style={styles.orderImage} />\r\n+              <div style={styles.orderItemDetails}>\r\n+                <p style={{ fontWeight: \"bold\", marginBottom: \"8px\", fontSize: \"0.95em\" }}>{item.name}</p>\r\n+                <div style={styles.orderDetailRow}>\r\n+                  <span>Số lượng:</span>\r\n+                  <span>{item.quantity}</span>\r\n+                </div>\r\n+                <div style={styles.orderDetailRow}>\r\n+                  <span>Màu:</span>\r\n+                  <span>{item.color}</span>\r\n+                </div>\r\n+                <div style={styles.orderDetailRow}>\r\n+                  <span>Size:</span>\r\n+                  <span>{item.size}</span>\r\n+                </div>\r\n+                <div style={styles.orderDetailRow}>\r\n+                  <span>Thời gian:</span>\r\n+                  <span>Dự kiến 5 ngày</span>\r\n+                </div>\r\n+                <div style={styles.orderDetailRow}>\r\n+                  <span>Giá:</span>\r\n+                  <span>{item.price}</span>\r\n+                </div>\r\n               </div>\r\n-              <div style={{\r\n-                display: \"flex\",\r\n-                justifyContent: \"space-between\",\r\n-                marginBottom: \"4px\",\r\n-                fontSize: \"0.7em\",\r\n-                color: \"#000000\",\r\n-              }}>\r\n-                <span>Màu:</span>\r\n-                <span>{item.color || \"Đen\"}</span>\r\n-              </div>\r\n-              <div style={{\r\n-                display: \"flex\",\r\n-                justifyContent: \"space-between\",\r\n-                marginBottom: \"4px\",\r\n-                fontSize: \"0.7em\",\r\n-                color: \"#000000\",\r\n-              }}>\r\n-                <span>Size:</span>\r\n-                <span>{item.size || \"Unknown\"}</span>\r\n-              </div>\r\n-              <div style={{\r\n-                display: \"flex\",\r\n-                justifyContent: \"space-between\",\r\n-                marginBottom: \"4px\",\r\n-                fontSize: \"0.7em\",\r\n-                color: \"#000000\",\r\n-              }}>\r\n-                <span>Thời gian:</span>\r\n-                <span>{item.shippingInfo || \"Dự kiến 5 ngày\"}</span>\r\n-              </div>\r\n-              <div style={{\r\n-                display: \"flex\",\r\n-                justifyContent: \"space-between\",\r\n-                marginBottom: \"4px\",\r\n-                fontSize: \"0.7em\",\r\n-                color: \"#000000\",\r\n-              }}>\r\n-                <span>Giá:</span>\r\n-                <span>{(item.price * item.quantity).toLocaleString('vi-VN')} VND</span>\r\n-              </div>\r\n             </div>\r\n+          ))}\r\n+          <div style={styles.orderTotals}>\r\n+            <div style={styles.orderTotalRow}>\r\n+              <span>Tổng phụ</span>\r\n+              <span>{order.subtotal.replace('AU$', '').trim()} VND</span>\r\n+            </div>\r\n+            <div style={styles.orderTotalRow}>\r\n+              <span>Vận chuyển</span>\r\n+              <span>Miễn phí (Express)</span>\r\n+            </div>\r\n+            <div style={styles.orderTotalRow}>\r\n+              <span style={{ fontWeight: \"bold\" }}>Tổng cộng</span>\r\n+              <span style={{ fontWeight: \"bold\" }}>{order.total.replace('AU$', '').trim()} VND</span>\r\n+            </div>\r\n           </div>\r\n-        ))}\r\n-        \r\n-        <div style={{\r\n-          display: \"flex\",\r\n-          justifyContent: \"space-between\",\r\n-          marginBottom: \"8px\",\r\n-          fontSize: \"0.7em\",\r\n-          color: \"#000000\",\r\n-        }}>\r\n-          <span>Vận chuyển</span>\r\n-          <span>Miễn phí (Express)</span>\r\n         </div>\r\n-        {isPromoApplied && (\r\n-          <div style={{\r\n-            display: \"flex\",\r\n-            justifyContent: \"space-between\",\r\n-            marginBottom: \"8px\",\r\n-            fontSize: \"0.7em\",\r\n-            color: \"#000000\",\r\n-          }}>\r\n-            <span>Mã giảm giá</span>\r\n-            <span>- {promoAmount.toLocaleString('vi-VN')} VND</span>\r\n+        <div style={{ ...styles.viewDetailsSection, borderTop: \"1px solid #000000\", paddingTop: \"10px\" }}>\r\n+          <div style={styles.viewDetails}>VIEW DETAILS</div>\r\n+          <div style={styles.billingNote}>\r\n+            Please note that your billing details will be verified and your credit card will be charged at the time of\r\n+            shipment. For Made to Order, DIY, personalised and selected Décor items, payment will be taken at the time the\r\n+            order is placed.\r\n           </div>\r\n-        )}\r\n-        <div style={{\r\n-          display: \"flex\",\r\n-          justifyContent: \"space-between\",\r\n-          marginBottom: \"8px\",\r\n-          fontSize: \"0.7em\",\r\n-          fontWeight: \"bold\",\r\n-          color: \"#000000\",\r\n-        }}>\r\n-          <span>Tổng cộng</span>\r\n-          <span>{calculateTotal()}</span>\r\n         </div>\r\n-      </div>\r\n-      <div style={{ \r\n-        borderTop: \"1px solid #000000\", \r\n-        paddingTop: \"10px\",\r\n-        marginTop: \"20px\"\r\n-      }}>\r\n-        <div style={{\r\n-          display: \"flex\",\r\n-          gap: \"10px\",\r\n-          marginBottom: \"15px\",\r\n-        }}>\r\n-          <input\r\n-            type=\"text\"\r\n-            value={promoCode}\r\n-            onChange={(e) => {\r\n-              setPromoCode(e.target.value);\r\n-              if (promoMessage) {\r\n-                setPromoMessage(\"\");\r\n-              }\r\n-            }}\r\n\\ No newline at end of file\n-            placeholder=\"Enter promo code\"\r\n-            style={{\r\n-              flex: 1,\r\n-              padding: \"8px\",\r\n-              fontSize: \"0.7em\",\r\n-              border: \"1px solid #000000\",\r\n-              color: \"#000000\",\r\n-            }}\r\n-          />\r\n-          <button\r\n-            onClick={handleApplyPromoCode}\r\n-            style={{\r\n-              padding: \"8px 15px\",\r\n-              fontSize: \"0.7em\",\r\n-              backgroundColor: \"#000000\",\r\n-              color: \"#ffffff\",\r\n-              border: \"none\",\r\n-              cursor: \"pointer\",\r\n-            }}\r\n-          >\r\n-            Apply\r\n-          </button>\r\n-          {isPromoApplied && (\r\n-            <button\r\n-              onClick={handleResetPromoCode}\r\n-              style={{\r\n-                padding: \"8px 15px\",\r\n-                fontSize: \"0.7em\",\r\n-                backgroundColor: \"#dc2626\",\r\n-                color: \"#ffffff\",\r\n-                border: \"none\",\r\n-                cursor: \"pointer\",\r\n-              }}\r\n-            >\r\n-              Reset\r\n-            </button>\r\n-          )}\r\n+        <div style={{ ...styles.helpSection, borderTop: \"1px solid #000000\", borderBottom: \"1px solid #000000\", paddingTop: \"10px\", paddingBottom: \"10px\" }}>\r\n+          <p style={{ marginBottom: \"10px\", fontWeight: \"bold\" }}>MAY WE HELP?</p>\r\n+          <p style={{ marginBottom: \"10px\" }}>+61 1300492212</p>\r\n+          <p style={{ marginBottom: \"10px\" }}>clientservice.au@gucci.com</p>\r\n         </div>\r\n-        {promoMessage && (\r\n-          <p style={{\r\n-            fontSize: \"0.7em\",\r\n-            color: isPromoApplied ? \"#059669\" : \"#dc2626\",\r\n-            marginBottom: \"10px\"\r\n-          }}>\r\n-            {promoMessage}\r\n-          </p>\r\n-        )}\r\n       </div>\r\n-    </div>\r\n-  );\r\n-}\n+    );\r\n+  }\r\n+  \r\n+  const styles = {\r\n+    rightSection: {\r\n+      flex: 1,\r\n+      backgroundColor: \"#ffffff\",\r\n+      padding: \"15px\",\r\n+      border: \"1px solid #e0e0e0\",\r\n+      color: \"#000000\",\r\n+      display: \"flex\",\r\n+      flexDirection: \"column\",\r\n+      gap: \"20px\",\r\n+    },\r\n+    orderSummary: {\r\n+      color: \"#000000\",\r\n+    },\r\n+    sectionTitle: {\r\n+      fontSize: \"1.1em\",\r\n+      fontWeight: \"bold\",\r\n+      marginBottom: \"15px\",\r\n+      color: \"#000000\",\r\n+      display: \"flex\",\r\n+      alignItems: \"center\",\r\n+      gap: \"8px\",\r\n+    },\r\n+    orderItem: {\r\n+      display: \"flex\",\r\n+      gap: \"15px\",\r\n+      marginBottom: \"25px\",\r\n+      color: \"#000000\",\r\n+    },\r\n+    orderImage: {\r\n+      width: \"80px\",\r\n+      height: \"80px\",\r\n+      objectFit: \"cover\",\r\n+    },\r\n+    orderItemDetails: {\r\n+      color: \"#000000\",\r\n+      flex: 1,\r\n+    },\r\n+    orderDetailRow: {\r\n+      display: \"flex\",\r\n+      justifyContent: \"space-between\",\r\n+      marginBottom: \"8px\",\r\n+      fontSize: \"0.75em\",\r\n+    },\r\n+    orderTotals: {\r\n+      color: \"#000000\",\r\n+    },\r\n+    orderTotalRow: {\r\n+      display: \"flex\",\r\n+      justifyContent: \"space-between\",\r\n+      marginBottom: \"12px\",\r\n+    },\r\n+    viewDetailsSection: {\r\n+      color: \"#000000\",\r\n+    },\r\n+    viewDetails: {\r\n+      fontSize: \"0.8em\",\r\n+      marginTop: \"15px\",\r\n+      marginBottom: \"15px\",\r\n+      cursor: \"pointer\",\r\n+      textDecoration: \"underline\",\r\n+      color: \"#000000\",\r\n+    },\r\n+    billingNote: {\r\n+      fontSize: \"0.75em\",\r\n+      color: \"#000000\",\r\n+      marginTop: \"15px\",\r\n+      marginBottom: \"15px\",\r\n+    },\r\n+    helpSection: {\r\n+      fontSize: \"0.8em\",\r\n+      color: \"#000000\",\r\n+    },\r\n+    \"@media (maxWidth: 768px)\": {\r\n+      rightSection: {\r\n+        order: -1,\r\n+      },\r\n+    },\r\n+  };\n\\ No newline at end of file\n"
                },
                {
                    "date": 1746902239014,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -27,25 +27,27 @@\n                   <span>Dự kiến 5 ngày</span>\r\n                 </div>\r\n                 <div style={styles.orderDetailRow}>\r\n                   <span>Giá:</span>\r\n-                  <span>{item.price}</span>\r\n+                  <span>{item.price.toLocaleString('vi-VN')} VND</span>\r\n                 </div>\r\n               </div>\r\n             </div>\r\n           ))}\r\n           <div style={styles.orderTotals}>\r\n+            {order.promoAmount > 0 && (\r\n+              <div style={styles.orderTotalRow}>\r\n+                <span>Mã giảm giá</span>\r\n+                <span>- {order.promoAmount.toLocaleString('vi-VN')} VND</span>\r\n+              </div>\r\n+            )}\r\n             <div style={styles.orderTotalRow}>\r\n-              <span>Tổng phụ</span>\r\n-              <span>{order.subtotal.replace('AU$', '').trim()} VND</span>\r\n-            </div>\r\n-            <div style={styles.orderTotalRow}>\r\n               <span>Vận chuyển</span>\r\n               <span>Miễn phí (Express)</span>\r\n             </div>\r\n             <div style={styles.orderTotalRow}>\r\n               <span style={{ fontWeight: \"bold\" }}>Tổng cộng</span>\r\n-              <span style={{ fontWeight: \"bold\" }}>{order.total.replace('AU$', '').trim()} VND</span>\r\n+              <span style={{ fontWeight: \"bold\" }}>{order.total.toLocaleString('vi-VN')} VND</span>\r\n             </div>\r\n           </div>\r\n         </div>\r\n         <div style={{ ...styles.viewDetailsSection, borderTop: \"1px solid #000000\", paddingTop: \"10px\" }}>\r\n"
                },
                {
                    "date": 1746902338814,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -27,27 +27,25 @@\n                   <span>Dự kiến 5 ngày</span>\r\n                 </div>\r\n                 <div style={styles.orderDetailRow}>\r\n                   <span>Giá:</span>\r\n-                  <span>{item.price.toLocaleString('vi-VN')} VND</span>\r\n+                  <span>{item.price}</span>\r\n                 </div>\r\n               </div>\r\n             </div>\r\n           ))}\r\n           <div style={styles.orderTotals}>\r\n-            {order.promoAmount > 0 && (\r\n-              <div style={styles.orderTotalRow}>\r\n-                <span>Mã giảm giá</span>\r\n-                <span>- {order.promoAmount.toLocaleString('vi-VN')} VND</span>\r\n-              </div>\r\n-            )}\r\n             <div style={styles.orderTotalRow}>\r\n+              <span>Tổng phụ</span>\r\n+              <span>{order.subtotal.replace('AU$', '').trim()} VND</span>\r\n+            </div>\r\n+            <div style={styles.orderTotalRow}>\r\n               <span>Vận chuyển</span>\r\n               <span>Miễn phí (Express)</span>\r\n             </div>\r\n             <div style={styles.orderTotalRow}>\r\n               <span style={{ fontWeight: \"bold\" }}>Tổng cộng</span>\r\n-              <span style={{ fontWeight: \"bold\" }}>{order.total.toLocaleString('vi-VN')} VND</span>\r\n+              <span style={{ fontWeight: \"bold\" }}>{order.total.replace('AU$', '').trim()} VND</span>\r\n             </div>\r\n           </div>\r\n         </div>\r\n         <div style={{ ...styles.viewDetailsSection, borderTop: \"1px solid #000000\", paddingTop: \"10px\" }}>\r\n"
                },
                {
                    "date": 1746902441502,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,40 @@\n+import React, { useState } from \"react\";\r\n+\r\n export default function OrderSummary({ order }) {\r\n+    const [promoCode, setPromoCode] = useState(\"\");\r\n+    const [promoMessage, setPromoMessage] = useState(\"\");\r\n+\r\n+    const handleApplyPromoCode = async () => {\r\n+      setPromoMessage(\"\");\r\n+      if (!promoCode.trim()) {\r\n+        setPromoMessage(\"Vui lòng nhập mã giảm giá\");\r\n+        return;\r\n+      }\r\n+\r\n+      try {\r\n+        const response = await fetch(\"/api/admin/notifications\");\r\n+        const data = await response.json();\r\n+        \r\n+        if (data.ok && data.promoCodes) {\r\n+          const foundPromo = data.promoCodes.find(\r\n+            promo => promo.code.toLowerCase() === promoCode.toLowerCase() && promo.isActive\r\n+          );\r\n+          \r\n+          if (foundPromo) {\r\n+            setPromoMessage(`Mã giảm giá ${foundPromo.amount.toLocaleString('vi-VN')} VND đã được áp dụng!`);\r\n+          } else {\r\n+            setPromoMessage(\"Mã giảm giá không hợp lệ hoặc đã hết hạn\");\r\n+          }\r\n+        } else {\r\n+          setPromoMessage(\"Không thể kiểm tra mã giảm giá\");\r\n+        }\r\n+      } catch (error) {\r\n+        console.error(\"Error applying promo code:\", error);\r\n+        setPromoMessage(\"Có lỗi xảy ra khi áp dụng mã giảm giá\");\r\n+      }\r\n+    };\r\n+\r\n     return (\r\n       <div style={styles.rightSection}>\r\n         <div style={styles.orderSummary}>\r\n           <h2 style={{ ...styles.sectionTitle, textAlign: \"center\", borderBottom: \"1px solid #000000\", paddingBottom: \"10px\" }}>\r\n@@ -33,19 +68,62 @@\n               </div>\r\n             </div>\r\n           ))}\r\n           <div style={styles.orderTotals}>\r\n+            {order.promoAmount > 0 ? (\r\n+              <div style={styles.orderTotalRow}>\r\n+                <span>Mã giảm giá</span>\r\n+                <span>- {order.promoAmount.toLocaleString('vi-VN')} VND</span>\r\n+              </div>\r\n+            ) : (\r\n+              <div style={{ marginBottom: \"15px\" }}>\r\n+                <div style={{ display: \"flex\", gap: \"10px\", marginBottom: \"10px\" }}>\r\n+                  <input\r\n+                    type=\"text\"\r\n+                    value={promoCode}\r\n+                    onChange={(e) => {\r\n+                      setPromoCode(e.target.value);\r\n+                      if (promoMessage) setPromoMessage(\"\");\r\n+                    }}\r\n+                    placeholder=\"Nhập mã giảm giá\"\r\n+                    style={{\r\n+                      flex: 1,\r\n+                      padding: \"8px\",\r\n+                      fontSize: \"0.7em\",\r\n+                      border: \"1px solid #000000\",\r\n+                    }}\r\n+                  />\r\n+                  <button\r\n+                    onClick={handleApplyPromoCode}\r\n+                    style={{\r\n+                      padding: \"8px 15px\",\r\n+                      fontSize: \"0.7em\",\r\n+                      backgroundColor: \"#000000\",\r\n+                      color: \"#ffffff\",\r\n+                      border: \"none\",\r\n+                      cursor: \"pointer\",\r\n+                    }}\r\n+                  >\r\n+                    Áp dụng\r\n+                  </button>\r\n+                </div>\r\n+                {promoMessage && (\r\n+                  <p style={{\r\n+                    fontSize: \"0.7em\",\r\n+                    color: promoMessage.includes(\"đã được áp dụng\") ? \"#059669\" : \"#dc2626\",\r\n+                  }}>\r\n+                    {promoMessage}\r\n+                  </p>\r\n+                )}\r\n+              </div>\r\n+            )}\r\n             <div style={styles.orderTotalRow}>\r\n-              <span>Tổng phụ</span>\r\n-              <span>{order.subtotal.replace('AU$', '').trim()} VND</span>\r\n-            </div>\r\n-            <div style={styles.orderTotalRow}>\r\n               <span>Vận chuyển</span>\r\n               <span>Miễn phí (Express)</span>\r\n             </div>\r\n             <div style={styles.orderTotalRow}>\r\n               <span style={{ fontWeight: \"bold\" }}>Tổng cộng</span>\r\n-              <span style={{ fontWeight: \"bold\" }}>{order.total.replace('AU$', '').trim()} VND</span>\r\n+              <span style={{ fontWeight: \"bold\" }}>{order.total.toLocaleString('vi-VN')} VND</span>\r\n             </div>\r\n           </div>\r\n         </div>\r\n         <div style={{ ...styles.viewDetailsSection, borderTop: \"1px solid #000000\", paddingTop: \"10px\" }}>\r\n"
                },
                {
                    "date": 1746902524088,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -62,9 +62,9 @@\n                   <span>Dự kiến 5 ngày</span>\r\n                 </div>\r\n                 <div style={styles.orderDetailRow}>\r\n                   <span>Giá:</span>\r\n-                  <span>{item.price}</span>\r\n+                  <span>{item.price.toLocaleString('vi-VN')} VND</span>\r\n                 </div>\r\n               </div>\r\n             </div>\r\n           ))}\r\n"
                },
                {
                    "date": 1746902596187,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,8 +3,13 @@\n export default function OrderSummary({ order }) {\r\n     const [promoCode, setPromoCode] = useState(\"\");\r\n     const [promoMessage, setPromoMessage] = useState(\"\");\r\n \r\n+    const calculateTotal = () => {\r\n+      const subtotal = order.items.reduce((total, item) => total + (item.price * item.quantity), 0);\r\n+      return subtotal - (order.promoAmount || 0);\r\n+    };\r\n+\r\n     const handleApplyPromoCode = async () => {\r\n       setPromoMessage(\"\");\r\n       if (!promoCode.trim()) {\r\n         setPromoMessage(\"Vui lòng nhập mã giảm giá\");\r\n@@ -62,9 +67,9 @@\n                   <span>Dự kiến 5 ngày</span>\r\n                 </div>\r\n                 <div style={styles.orderDetailRow}>\r\n                   <span>Giá:</span>\r\n-                  <span>{item.price.toLocaleString('vi-VN')} VND</span>\r\n+                  <span>{(item.price * item.quantity).toLocaleString('vi-VN')} VND</span>\r\n                 </div>\r\n               </div>\r\n             </div>\r\n           ))}\r\n@@ -121,9 +126,9 @@\n               <span>Miễn phí (Express)</span>\r\n             </div>\r\n             <div style={styles.orderTotalRow}>\r\n               <span style={{ fontWeight: \"bold\" }}>Tổng cộng</span>\r\n-              <span style={{ fontWeight: \"bold\" }}>{order.total.toLocaleString('vi-VN')} VND</span>\r\n+              <span style={{ fontWeight: \"bold\" }}>{calculateTotal().toLocaleString('vi-VN')} VND</span>\r\n             </div>\r\n           </div>\r\n         </div>\r\n         <div style={{ ...styles.viewDetailsSection, borderTop: \"1px solid #000000\", paddingTop: \"10px\" }}>\r\n"
                },
                {
                    "date": 1746902677400,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,9 +4,12 @@\n     const [promoCode, setPromoCode] = useState(\"\");\r\n     const [promoMessage, setPromoMessage] = useState(\"\");\r\n \r\n     const calculateTotal = () => {\r\n-      const subtotal = order.items.reduce((total, item) => total + (item.price * item.quantity), 0);\r\n+      const subtotal = order.items.reduce((total, item) => {\r\n+        const price = parseFloat(item.price) || 0;\r\n+        return total + (price * item.quantity);\r\n+      }, 0);\r\n       return subtotal - (order.promoAmount || 0);\r\n     };\r\n \r\n     const handleApplyPromoCode = async () => {\r\n@@ -44,36 +47,39 @@\n         <div style={styles.orderSummary}>\r\n           <h2 style={{ ...styles.sectionTitle, textAlign: \"center\", borderBottom: \"1px solid #000000\", paddingBottom: \"10px\" }}>\r\n             ORDER SUMMARY\r\n           </h2>\r\n-          {order.items.map((item, index) => (\r\n-            <div key={index} style={styles.orderItem}>\r\n-              <img src={item.image} alt={item.name} style={styles.orderImage} />\r\n-              <div style={styles.orderItemDetails}>\r\n-                <p style={{ fontWeight: \"bold\", marginBottom: \"8px\", fontSize: \"0.95em\" }}>{item.name}</p>\r\n-                <div style={styles.orderDetailRow}>\r\n-                  <span>Số lượng:</span>\r\n-                  <span>{item.quantity}</span>\r\n+          {order.items.map((item, index) => {\r\n+            const price = parseFloat(item.price) || 0;\r\n+            return (\r\n+              <div key={index} style={styles.orderItem}>\r\n+                <img src={item.image} alt={item.name} style={styles.orderImage} />\r\n+                <div style={styles.orderItemDetails}>\r\n+                  <p style={{ fontWeight: \"bold\", marginBottom: \"8px\", fontSize: \"0.95em\" }}>{item.name}</p>\r\n+                  <div style={styles.orderDetailRow}>\r\n+                    <span>Số lượng:</span>\r\n+                    <span>{item.quantity}</span>\r\n+                  </div>\r\n+                  <div style={styles.orderDetailRow}>\r\n+                    <span>Màu:</span>\r\n+                    <span>{item.color}</span>\r\n+                  </div>\r\n+                  <div style={styles.orderDetailRow}>\r\n+                    <span>Size:</span>\r\n+                    <span>{item.size}</span>\r\n+                  </div>\r\n+                  <div style={styles.orderDetailRow}>\r\n+                    <span>Thời gian:</span>\r\n+                    <span>Dự kiến 5 ngày</span>\r\n+                  </div>\r\n+                  <div style={styles.orderDetailRow}>\r\n+                    <span>Giá:</span>\r\n+                    <span>{(price * item.quantity).toLocaleString('vi-VN')} VND</span>\r\n+                  </div>\r\n                 </div>\r\n-                <div style={styles.orderDetailRow}>\r\n-                  <span>Màu:</span>\r\n-                  <span>{item.color}</span>\r\n-                </div>\r\n-                <div style={styles.orderDetailRow}>\r\n-                  <span>Size:</span>\r\n-                  <span>{item.size}</span>\r\n-                </div>\r\n-                <div style={styles.orderDetailRow}>\r\n-                  <span>Thời gian:</span>\r\n-                  <span>Dự kiến 5 ngày</span>\r\n-                </div>\r\n-                <div style={styles.orderDetailRow}>\r\n-                  <span>Giá:</span>\r\n-                  <span>{(item.price * item.quantity).toLocaleString('vi-VN')} VND</span>\r\n-                </div>\r\n               </div>\r\n-            </div>\r\n-          ))}\r\n+            );\r\n+          })}\r\n           <div style={styles.orderTotals}>\r\n             {order.promoAmount > 0 ? (\r\n               <div style={styles.orderTotalRow}>\r\n                 <span>Mã giảm giá</span>\r\n"
                },
                {
                    "date": 1746902739797,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,9 +5,10 @@\n     const [promoMessage, setPromoMessage] = useState(\"\");\r\n \r\n     const calculateTotal = () => {\r\n       const subtotal = order.items.reduce((total, item) => {\r\n-        const price = parseFloat(item.price) || 0;\r\n+        const priceStr = typeof item.price === 'string' ? item.price.replace('AU$', '').trim() : item.price;\r\n+        const price = parseFloat(priceStr) || 0;\r\n         return total + (price * item.quantity);\r\n       }, 0);\r\n       return subtotal - (order.promoAmount || 0);\r\n     };\r\n@@ -48,9 +49,10 @@\n           <h2 style={{ ...styles.sectionTitle, textAlign: \"center\", borderBottom: \"1px solid #000000\", paddingBottom: \"10px\" }}>\r\n             ORDER SUMMARY\r\n           </h2>\r\n           {order.items.map((item, index) => {\r\n-            const price = parseFloat(item.price) || 0;\r\n+            const priceStr = typeof item.price === 'string' ? item.price.replace('AU$', '').trim() : item.price;\r\n+            const price = parseFloat(priceStr) || 0;\r\n             return (\r\n               <div key={index} style={styles.orderItem}>\r\n                 <img src={item.image} alt={item.name} style={styles.orderImage} />\r\n                 <div style={styles.orderItemDetails}>\r\n"
                },
                {
                    "date": 1746902820518,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,49 +1,27 @@\n-import React, { useState } from \"react\";\r\n+\"use client\";\r\n+import { useState, useEffect } from \"react\";\r\n+import { useCart } from \"../../../context/CartContext\";\r\n \r\n export default function OrderSummary({ order }) {\r\n-    const [promoCode, setPromoCode] = useState(\"\");\r\n-    const [promoMessage, setPromoMessage] = useState(\"\");\r\n+    const { cartItems, promoAmount } = useCart();\r\n+    const [isMounted, setIsMounted] = useState(false);\r\n \r\n+    useEffect(() => {\r\n+      setIsMounted(true);\r\n+    }, []);\r\n+\r\n     const calculateTotal = () => {\r\n       const subtotal = order.items.reduce((total, item) => {\r\n         const priceStr = typeof item.price === 'string' ? item.price.replace('AU$', '').trim() : item.price;\r\n         const price = parseFloat(priceStr) || 0;\r\n         return total + (price * item.quantity);\r\n       }, 0);\r\n-      return subtotal - (order.promoAmount || 0);\r\n+      return subtotal - (promoAmount || 0);\r\n     };\r\n \r\n-    const handleApplyPromoCode = async () => {\r\n-      setPromoMessage(\"\");\r\n-      if (!promoCode.trim()) {\r\n-        setPromoMessage(\"Vui lòng nhập mã giảm giá\");\r\n-        return;\r\n-      }\r\n+    if (!isMounted) return null;\r\n \r\n-      try {\r\n-        const response = await fetch(\"/api/admin/notifications\");\r\n-        const data = await response.json();\r\n-        \r\n-        if (data.ok && data.promoCodes) {\r\n-          const foundPromo = data.promoCodes.find(\r\n-            promo => promo.code.toLowerCase() === promoCode.toLowerCase() && promo.isActive\r\n-          );\r\n-          \r\n-          if (foundPromo) {\r\n-            setPromoMessage(`Mã giảm giá ${foundPromo.amount.toLocaleString('vi-VN')} VND đã được áp dụng!`);\r\n-          } else {\r\n-            setPromoMessage(\"Mã giảm giá không hợp lệ hoặc đã hết hạn\");\r\n-          }\r\n-        } else {\r\n-          setPromoMessage(\"Không thể kiểm tra mã giảm giá\");\r\n-        }\r\n-      } catch (error) {\r\n-        console.error(\"Error applying promo code:\", error);\r\n-        setPromoMessage(\"Có lỗi xảy ra khi áp dụng mã giảm giá\");\r\n-      }\r\n-    };\r\n-\r\n     return (\r\n       <div style={styles.rightSection}>\r\n         <div style={styles.orderSummary}>\r\n           <h2 style={{ ...styles.sectionTitle, textAlign: \"center\", borderBottom: \"1px solid #000000\", paddingBottom: \"10px\" }}>\r\n@@ -81,54 +59,13 @@\n               </div>\r\n             );\r\n           })}\r\n           <div style={styles.orderTotals}>\r\n-            {order.promoAmount > 0 ? (\r\n+            {promoAmount > 0 && (\r\n               <div style={styles.orderTotalRow}>\r\n                 <span>Mã giảm giá</span>\r\n-                <span>- {order.promoAmount.toLocaleString('vi-VN')} VND</span>\r\n+                <span>- {promoAmount.toLocaleString('vi-VN')} VND</span>\r\n               </div>\r\n-            ) : (\r\n-              <div style={{ marginBottom: \"15px\" }}>\r\n-                <div style={{ display: \"flex\", gap: \"10px\", marginBottom: \"10px\" }}>\r\n-                  <input\r\n-                    type=\"text\"\r\n-                    value={promoCode}\r\n-                    onChange={(e) => {\r\n-                      setPromoCode(e.target.value);\r\n-                      if (promoMessage) setPromoMessage(\"\");\r\n-                    }}\r\n-                    placeholder=\"Nhập mã giảm giá\"\r\n-                    style={{\r\n-                      flex: 1,\r\n-                      padding: \"8px\",\r\n-                      fontSize: \"0.7em\",\r\n-                      border: \"1px solid #000000\",\r\n-                    }}\r\n-                  />\r\n-                  <button\r\n-                    onClick={handleApplyPromoCode}\r\n-                    style={{\r\n-                      padding: \"8px 15px\",\r\n-                      fontSize: \"0.7em\",\r\n-                      backgroundColor: \"#000000\",\r\n-                      color: \"#ffffff\",\r\n-                      border: \"none\",\r\n-                      cursor: \"pointer\",\r\n-                    }}\r\n-                  >\r\n-                    Áp dụng\r\n-                  </button>\r\n-                </div>\r\n-                {promoMessage && (\r\n-                  <p style={{\r\n-                    fontSize: \"0.7em\",\r\n-                    color: promoMessage.includes(\"đã được áp dụng\") ? \"#059669\" : \"#dc2626\",\r\n-                  }}>\r\n-                    {promoMessage}\r\n-                  </p>\r\n-                )}\r\n-              </div>\r\n             )}\r\n             <div style={styles.orderTotalRow}>\r\n               <span>Vận chuyển</span>\r\n               <span>Miễn phí (Express)</span>\r\n"
                },
                {
                    "date": 1746902913492,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,9 +2,9 @@\n import { useState, useEffect } from \"react\";\r\n import { useCart } from \"../../../context/CartContext\";\r\n \r\n export default function OrderSummary({ order }) {\r\n-    const { cartItems, promoAmount } = useCart();\r\n+    const { cartItems, promoAmount, appliedPromoCode } = useCart();\r\n     const [isMounted, setIsMounted] = useState(false);\r\n \r\n     useEffect(() => {\r\n       setIsMounted(true);\r\n@@ -60,12 +60,22 @@\n             );\r\n           })}\r\n           <div style={styles.orderTotals}>\r\n             {promoAmount > 0 && (\r\n-              <div style={styles.orderTotalRow}>\r\n-                <span>Mã giảm giá</span>\r\n-                <span>- {promoAmount.toLocaleString('vi-VN')} VND</span>\r\n-              </div>\r\n+              <>\r\n+                <div style={styles.orderTotalRow}>\r\n+                  <span>Mã giảm giá ({appliedPromoCode})</span>\r\n+                  <span>- {promoAmount.toLocaleString('vi-VN')} VND</span>\r\n+                </div>\r\n+                <div style={{ \r\n+                  fontSize: \"0.7em\", \r\n+                  color: \"#059669\",\r\n+                  marginBottom: \"10px\",\r\n+                  textAlign: \"right\"\r\n+                }}>\r\n+                  Mã giảm giá đã được áp dụng\r\n+                </div>\r\n+              </>\r\n             )}\r\n             <div style={styles.orderTotalRow}>\r\n               <span>Vận chuyển</span>\r\n               <span>Miễn phí (Express)</span>\r\n"
                },
                {
                    "date": 1746903005677,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,22 +2,33 @@\n import { useState, useEffect } from \"react\";\r\n import { useCart } from \"../../../context/CartContext\";\r\n \r\n export default function OrderSummary({ order }) {\r\n-    const { cartItems, promoAmount, appliedPromoCode } = useCart();\r\n+    const { cartItems } = useCart();\r\n     const [isMounted, setIsMounted] = useState(false);\r\n+    const [promoAmount, setPromoAmount] = useState(0);\r\n+    const [appliedPromoCode, setAppliedPromoCode] = useState(\"\");\r\n \r\n     useEffect(() => {\r\n       setIsMounted(true);\r\n+      // Lấy thông tin mã giảm giá từ localStorage\r\n+      const savedPromoAmount = localStorage.getItem('promoAmount');\r\n+      const savedPromoCode = localStorage.getItem('appliedPromoCode');\r\n+      if (savedPromoAmount) {\r\n+        setPromoAmount(parseFloat(savedPromoAmount));\r\n+      }\r\n+      if (savedPromoCode) {\r\n+        setAppliedPromoCode(savedPromoCode);\r\n+      }\r\n     }, []);\r\n \r\n     const calculateTotal = () => {\r\n       const subtotal = order.items.reduce((total, item) => {\r\n         const priceStr = typeof item.price === 'string' ? item.price.replace('AU$', '').trim() : item.price;\r\n         const price = parseFloat(priceStr) || 0;\r\n         return total + (price * item.quantity);\r\n       }, 0);\r\n-      return subtotal - (promoAmount || 0);\r\n+      return subtotal - promoAmount;\r\n     };\r\n \r\n     if (!isMounted) return null;\r\n \r\n"
                },
                {
                    "date": 1746903022440,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,8 +9,9 @@\n     const [appliedPromoCode, setAppliedPromoCode] = useState(\"\");\r\n \r\n     useEffect(() => {\r\n       setIsMounted(true);\r\n+      // Lấy thông tin mã giảm giá từ localStorage\r\n       const savedPromoAmount = localStorage.getItem('promoAmount');\r\n       const savedPromoCode = localStorage.getItem('appliedPromoCode');\r\n       if (savedPromoAmount) {\r\n         setPromoAmount(parseFloat(savedPromoAmount));\r\n"
                }
            ],
            "date": 1746891704042,
            "name": "cart",
            "content": "export default function OrderSummary({ order }) {\r\n    return (\r\n      <div style={styles.rightSection}>\r\n        <div style={styles.orderSummary}>\r\n          <h2 style={{ ...styles.sectionTitle, textAlign: \"center\", borderBottom: \"1px solid #000000\", paddingBottom: \"10px\" }}>\r\n            ORDER SUMMARY\r\n          </h2>\r\n          {order.items.map((item, index) => (\r\n            <div key={index} style={styles.orderItem}>\r\n              <img src={item.image} alt={item.name} style={styles.orderImage} />\r\n              <div style={styles.orderItemDetails}>\r\n                <p style={{ fontWeight: \"bold\", marginBottom: \"8px\", fontSize: \"0.95em\" }}>{item.name}</p>\r\n                <div style={styles.orderDetailRow}>\r\n                  <span>Số lượng:</span>\r\n                  <span>{item.quantity}</span>\r\n                </div>\r\n                <div style={styles.orderDetailRow}>\r\n                  <span>Màu:</span>\r\n                  <span>{item.color}</span>\r\n                </div>\r\n                <div style={styles.orderDetailRow}>\r\n                  <span>Size:</span>\r\n                  <span>{item.size}</span>\r\n                </div>\r\n                <div style={styles.orderDetailRow}>\r\n                  <span>Thời gian:</span>\r\n                  <span>Dự kiến 5 ngày</span>\r\n                </div>\r\n                <div style={styles.orderDetailRow}>\r\n                  <span>Giá:</span>\r\n                  <span>{item.price}</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n          <div style={styles.orderTotals}>\r\n            <div style={styles.orderTotalRow}>\r\n              <span>Tổng phụ</span>\r\n              <span>{order.subtotal.replace('AU$', '').trim()} VND</span>\r\n            </div>\r\n            <div style={styles.orderTotalRow}>\r\n              <span>Vận chuyển</span>\r\n              <span>Miễn phí (Express)</span>\r\n            </div>\r\n            <div style={styles.orderTotalRow}>\r\n              <span style={{ fontWeight: \"bold\" }}>Tổng cộng</span>\r\n              <span style={{ fontWeight: \"bold\" }}>{order.total.replace('AU$', '').trim()} VND</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div style={{ ...styles.viewDetailsSection, borderTop: \"1px solid #000000\", paddingTop: \"10px\" }}>\r\n          <div style={styles.viewDetails}>VIEW DETAILS</div>\r\n          <div style={styles.billingNote}>\r\n            Please note that your billing details will be verified and your credit card will be charged at the time of\r\n            shipment. For Made to Order, DIY, personalised and selected Décor items, payment will be taken at the time the\r\n            order is placed.\r\n          </div>\r\n        </div>\r\n        <div style={{ ...styles.helpSection, borderTop: \"1px solid #000000\", borderBottom: \"1px solid #000000\", paddingTop: \"10px\", paddingBottom: \"10px\" }}>\r\n          <p style={{ marginBottom: \"10px\", fontWeight: \"bold\" }}>MAY WE HELP?</p>\r\n          <p style={{ marginBottom: \"10px\" }}>+61 1300492212</p>\r\n          <p style={{ marginBottom: \"10px\" }}>clientservice.au@gucci.com</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n  \r\n  const styles = {\r\n    rightSection: {\r\n      flex: 1,\r\n      backgroundColor: \"#ffffff\",\r\n      padding: \"15px\",\r\n      border: \"1px solid #e0e0e0\",\r\n      color: \"#000000\",\r\n      display: \"flex\",\r\n      flexDirection: \"column\",\r\n      gap: \"20px\",\r\n    },\r\n    orderSummary: {\r\n      color: \"#000000\",\r\n    },\r\n    sectionTitle: {\r\n      fontSize: \"1.1em\",\r\n      fontWeight: \"bold\",\r\n      marginBottom: \"15px\",\r\n      color: \"#000000\",\r\n      display: \"flex\",\r\n      alignItems: \"center\",\r\n      gap: \"8px\",\r\n    },\r\n    orderItem: {\r\n      display: \"flex\",\r\n      gap: \"15px\",\r\n      marginBottom: \"25px\",\r\n      color: \"#000000\",\r\n    },\r\n    orderImage: {\r\n      width: \"80px\",\r\n      height: \"80px\",\r\n      objectFit: \"cover\",\r\n    },\r\n    orderItemDetails: {\r\n      color: \"#000000\",\r\n      flex: 1,\r\n    },\r\n    orderDetailRow: {\r\n      display: \"flex\",\r\n      justifyContent: \"space-between\",\r\n      marginBottom: \"8px\",\r\n      fontSize: \"0.75em\",\r\n    },\r\n    orderTotals: {\r\n      color: \"#000000\",\r\n    },\r\n    orderTotalRow: {\r\n      display: \"flex\",\r\n      justifyContent: \"space-between\",\r\n      marginBottom: \"12px\",\r\n    },\r\n    viewDetailsSection: {\r\n      color: \"#000000\",\r\n    },\r\n    viewDetails: {\r\n      fontSize: \"0.8em\",\r\n      marginTop: \"15px\",\r\n      marginBottom: \"15px\",\r\n      cursor: \"pointer\",\r\n      textDecoration: \"underline\",\r\n      color: \"#000000\",\r\n    },\r\n    billingNote: {\r\n      fontSize: \"0.75em\",\r\n      color: \"#000000\",\r\n      marginTop: \"15px\",\r\n      marginBottom: \"15px\",\r\n    },\r\n    helpSection: {\r\n      fontSize: \"0.8em\",\r\n      color: \"#000000\",\r\n    },\r\n    \"@media (maxWidth: 768px)\": {\r\n      rightSection: {\r\n        order: -1,\r\n      },\r\n    },\r\n  };"
        }
    ]
}