{
    "sourceFile": "src/components/ChangePasswordForm.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1747243179768,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1747243179768,
            "name": "Commit-0",
            "content": "import { useState } from 'react';\r\nimport { useForm } from 'react-hook-form';\r\nimport { toast } from 'react-hot-toast';\r\n\r\ntype FormData = {\r\n  currentPassword: string;\r\n  newPassword: string;\r\n  confirmPassword: string;\r\n};\r\n\r\nexport default function ChangePasswordForm() {\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const { register, handleSubmit, reset, formState: { errors }, watch } = useForm<FormData>();\r\n  const newPassword = watch('newPassword');\r\n\r\n  const onSubmit = async (data: FormData) => {\r\n    if (data.newPassword !== data.confirmPassword) {\r\n      toast.error('Mật khẩu mới không khớp');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setIsLoading(true);\r\n      const response = await fetch('/api/change-password', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          currentPassword: data.currentPassword,\r\n          newPassword: data.newPassword,\r\n        }),\r\n      });\r\n\r\n      const result = await response.json();\r\n\r\n      if (!response.ok) {\r\n        throw new Error(result.error || 'Có lỗi xảy ra');\r\n      }\r\n\r\n      toast.success('Đổi mật khẩu thành công');\r\n      reset();\r\n    } catch (error) {\r\n      toast.error(error instanceof Error ? error.message : 'Có lỗi xảy ra');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-6\">\r\n      <div>\r\n        <label htmlFor=\"currentPassword\" className=\"block text-sm font-medium text-gray-700\">\r\n          Mật khẩu hiện tại\r\n        </label>\r\n        <input\r\n          type=\"password\"\r\n          id=\"currentPassword\"\r\n          {...register('currentPassword', { required: 'Vui lòng nhập mật khẩu hiện tại' })}\r\n          className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-black focus:ring-black sm:text-sm\"\r\n        />\r\n        {errors.currentPassword && (\r\n          <p className=\"mt-1 text-sm text-red-600\">{errors.currentPassword.message}</p>\r\n        )}\r\n      </div>\r\n\r\n      <div>\r\n        <label htmlFor=\"newPassword\" className=\"block text-sm font-medium text-gray-700\">\r\n          Mật khẩu mới\r\n        </label>\r\n        <input\r\n          type=\"password\"\r\n          id=\"newPassword\"\r\n          {...register('newPassword', {\r\n            required: 'Vui lòng nhập mật khẩu mới',\r\n            minLength: {\r\n              value: 8,\r\n              message: 'Mật khẩu phải có ít nhất 8 ký tự'\r\n            }\r\n          })}\r\n          className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-black focus:ring-black sm:text-sm\"\r\n        />\r\n        {errors.newPassword && (\r\n          <p className=\"mt-1 text-sm text-red-600\">{errors.newPassword.message}</p>\r\n        )}\r\n      </div>\r\n\r\n      <div>\r\n        <label htmlFor=\"confirmPassword\" className=\"block text-sm font-medium text-gray-700\">\r\n          Xác nhận mật khẩu mới\r\n        </label>\r\n        <input\r\n          type=\"password\"\r\n          id=\"confirmPassword\"\r\n          {...register('confirmPassword', {\r\n            required: 'Vui lòng xác nhận mật khẩu mới',\r\n            validate: value => value === newPassword || 'Mật khẩu không khớp'\r\n          })}\r\n          className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-black focus:ring-black sm:text-sm\"\r\n        />\r\n        {errors.confirmPassword && (\r\n          <p className=\"mt-1 text-sm text-red-600\">{errors.confirmPassword.message}</p>\r\n        )}\r\n      </div>\r\n\r\n      <div>\r\n        <button\r\n          type=\"submit\"\r\n          disabled={isLoading}\r\n          className=\"flex w-full justify-center rounded-md border border-transparent bg-black py-2 px-4 text-sm font-medium text-white shadow-sm hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-black focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n        >\r\n          {isLoading ? 'Đang xử lý...' : 'Đổi mật khẩu'}\r\n        </button>\r\n      </div>\r\n    </form>\r\n  );\r\n} "
        }
    ]
}