{
    "sourceFile": "node_modules/next/dist/build/webpack-build/impl.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1746892674017,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1746891704042,
            "name": "cart",
            "content": "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n0 && (module.exports = {\n    webpackBuildImpl: null,\n    workerMain: null\n});\nfunction _export(target, all) {\n    for(var name in all)Object.defineProperty(target, name, {\n        enumerable: true,\n        get: all[name]\n    });\n}\n_export(exports, {\n    webpackBuildImpl: function() {\n        return webpackBuildImpl;\n    },\n    workerMain: function() {\n        return workerMain;\n    }\n});\nconst _webpacksources3 = require(\"next/dist/compiled/webpack-sources3\");\nconst _picocolors = require(\"../../lib/picocolors\");\nconst _formatwebpackmessages = /*#__PURE__*/ _interop_require_default(require(\"../../client/components/react-dev-overlay/utils/format-webpack-messages\"));\nconst _nonnullable = require(\"../../lib/non-nullable\");\nconst _constants = require(\"../../shared/lib/constants\");\nconst _compiler = require(\"../compiler\");\nconst _log = /*#__PURE__*/ _interop_require_wildcard(require(\"../output/log\"));\nconst _webpackconfig = /*#__PURE__*/ _interop_require_wildcard(require(\"../webpack-config\"));\nconst _telemetryplugin = require(\"../webpack/plugins/telemetry-plugin/telemetry-plugin\");\nconst _buildcontext = require(\"../build-context\");\nconst _entries = require(\"../entries\");\nconst _config = /*#__PURE__*/ _interop_require_default(require(\"../../server/config\"));\nconst _trace = require(\"../../trace\");\nconst _constants1 = require(\"../../lib/constants\");\nconst _nexttraceentrypointsplugin = require(\"../webpack/plugins/next-trace-entrypoints-plugin\");\nconst _debug = /*#__PURE__*/ _interop_require_default(require(\"next/dist/compiled/debug\"));\nconst _storage = require(\"../../telemetry/storage\");\nconst _durationtostring = require(\"../duration-to-string\");\nfunction _interop_require_default(obj) {\n    return obj && obj.__esModule ? obj : {\n        default: obj\n    };\n}\nfunction _getRequireWildcardCache(nodeInterop) {\n    if (typeof WeakMap !== \"function\") return null;\n    var cacheBabelInterop = new WeakMap();\n    var cacheNodeInterop = new WeakMap();\n    return (_getRequireWildcardCache = function(nodeInterop) {\n        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;\n    })(nodeInterop);\n}\nfunction _interop_require_wildcard(obj, nodeInterop) {\n    if (!nodeInterop && obj && obj.__esModule) {\n        return obj;\n    }\n    if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") {\n        return {\n            default: obj\n        };\n    }\n    var cache = _getRequireWildcardCache(nodeInterop);\n    if (cache && cache.has(obj)) {\n        return cache.get(obj);\n    }\n    var newObj = {\n        __proto__: null\n    };\n    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n    for(var key in obj){\n        if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) {\n            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n            if (desc && (desc.get || desc.set)) {\n                Object.defineProperty(newObj, key, desc);\n            } else {\n                newObj[key] = obj[key];\n            }\n        }\n    }\n    newObj.default = obj;\n    if (cache) {\n        cache.set(obj, newObj);\n    }\n    return newObj;\n}\nconst debug = (0, _debug.default)('next:build:webpack-build');\nfunction isTelemetryPlugin(plugin) {\n    return plugin instanceof _telemetryplugin.TelemetryPlugin;\n}\nfunction isTraceEntryPointsPlugin(plugin) {\n    return plugin instanceof _nexttraceentrypointsplugin.TraceEntryPointsPlugin;\n}\nasync function webpackBuildImpl(compilerName) {\n    var _clientConfig_plugins, _serverConfig_plugins;\n    let result = {\n        warnings: [],\n        errors: [],\n        stats: []\n    };\n    let webpackBuildStart;\n    const nextBuildSpan = _buildcontext.NextBuildContext.nextBuildSpan;\n    const dir = _buildcontext.NextBuildContext.dir;\n    const config = _buildcontext.NextBuildContext.config;\n    process.env.NEXT_COMPILER_NAME = compilerName || 'server';\n    const runWebpackSpan = nextBuildSpan.traceChild('run-webpack-compiler');\n    const entrypoints = await nextBuildSpan.traceChild('create-entrypoints').traceAsyncFn(()=>(0, _entries.createEntrypoints)({\n            buildId: _buildcontext.NextBuildContext.buildId,\n            config: config,\n            envFiles: _buildcontext.NextBuildContext.loadedEnvFiles,\n            isDev: false,\n            rootDir: dir,\n            pageExtensions: config.pageExtensions,\n            pagesDir: _buildcontext.NextBuildContext.pagesDir,\n            appDir: _buildcontext.NextBuildContext.appDir,\n            pages: _buildcontext.NextBuildContext.mappedPages,\n            appPaths: _buildcontext.NextBuildContext.mappedAppPages,\n            previewMode: _buildcontext.NextBuildContext.previewProps,\n            rootPaths: _buildcontext.NextBuildContext.mappedRootPaths,\n            hasInstrumentationHook: _buildcontext.NextBuildContext.hasInstrumentationHook\n        }));\n    const commonWebpackOptions = {\n        isServer: false,\n        isCompileMode: _buildcontext.NextBuildContext.isCompileMode,\n        buildId: _buildcontext.NextBuildContext.buildId,\n        encryptionKey: _buildcontext.NextBuildContext.encryptionKey,\n        config: config,\n        appDir: _buildcontext.NextBuildContext.appDir,\n        pagesDir: _buildcontext.NextBuildContext.pagesDir,\n        rewrites: _buildcontext.NextBuildContext.rewrites,\n        originalRewrites: _buildcontext.NextBuildContext.originalRewrites,\n        originalRedirects: _buildcontext.NextBuildContext.originalRedirects,\n        reactProductionProfiling: _buildcontext.NextBuildContext.reactProductionProfiling,\n        noMangling: _buildcontext.NextBuildContext.noMangling,\n        clientRouterFilters: _buildcontext.NextBuildContext.clientRouterFilters,\n        previewModeId: _buildcontext.NextBuildContext.previewModeId,\n        allowedRevalidateHeaderKeys: _buildcontext.NextBuildContext.allowedRevalidateHeaderKeys,\n        fetchCacheKeyPrefix: _buildcontext.NextBuildContext.fetchCacheKeyPrefix\n    };\n    const configs = await runWebpackSpan.traceChild('generate-webpack-config').traceAsyncFn(async ()=>{\n        const info = await (0, _webpackconfig.loadProjectInfo)({\n            dir,\n            config: commonWebpackOptions.config,\n            dev: false\n        });\n        return Promise.all([\n            (0, _webpackconfig.default)(dir, {\n                ...commonWebpackOptions,\n                middlewareMatchers: entrypoints.middlewareMatchers,\n                runWebpackSpan,\n                compilerType: _constants.COMPILER_NAMES.client,\n                entrypoints: entrypoints.client,\n                ...info\n            }),\n            (0, _webpackconfig.default)(dir, {\n                ...commonWebpackOptions,\n                runWebpackSpan,\n                middlewareMatchers: entrypoints.middlewareMatchers,\n                compilerType: _constants.COMPILER_NAMES.server,\n                entrypoints: entrypoints.server,\n                ...info\n            }),\n            (0, _webpackconfig.default)(dir, {\n                ...commonWebpackOptions,\n                runWebpackSpan,\n                middlewareMatchers: entrypoints.middlewareMatchers,\n                compilerType: _constants.COMPILER_NAMES.edgeServer,\n                entrypoints: entrypoints.edgeServer,\n                edgePreviewProps: {\n                    __NEXT_PREVIEW_MODE_ID: _buildcontext.NextBuildContext.previewProps.previewModeId,\n                    __NEXT_PREVIEW_MODE_ENCRYPTION_KEY: _buildcontext.NextBuildContext.previewProps.previewModeEncryptionKey,\n                    __NEXT_PREVIEW_MODE_SIGNING_KEY: _buildcontext.NextBuildContext.previewProps.previewModeSigningKey\n                },\n                ...info\n            })\n        ]);\n    });\n    const clientConfig = configs[0];\n    const serverConfig = configs[1];\n    const edgeConfig = configs[2];\n    if (clientConfig.optimization && (clientConfig.optimization.minimize !== true || clientConfig.optimization.minimizer && clientConfig.optimization.minimizer.length === 0)) {\n        _log.warn(`Production code optimization has been disabled in your project. Read more: https://nextjs.org/docs/messages/minification-disabled`);\n    }\n    webpackBuildStart = process.hrtime();\n    debug(`starting compiler`, compilerName);\n    // We run client and server compilation separately to optimize for memory usage\n    await runWebpackSpan.traceAsyncFn(async ()=>{\n        var _inputFileSystem_purge;\n        if (config.experimental.webpackMemoryOptimizations) {\n            _webpacksources3.stringBufferUtils.disableDualStringBufferCaching();\n            _webpacksources3.stringBufferUtils.enterStringInterningRange();\n        }\n        // Run the server compilers first and then the client\n        // compiler to track the boundary of server/client components.\n        let clientResult = null;\n        // During the server compilations, entries of client components will be\n        // injected to this set and then will be consumed by the client compiler.\n        let serverResult = null;\n        let edgeServerResult = null;\n        let inputFileSystem;\n        if (!compilerName || compilerName === 'server') {\n            debug('starting server compiler');\n            const start = Date.now();\n            [serverResult, inputFileSystem] = await (0, _compiler.runCompiler)(serverConfig, {\n                runWebpackSpan,\n                inputFileSystem\n            });\n            debug(`server compiler finished ${Date.now() - start}ms`);\n        }\n        if (!compilerName || compilerName === 'edge-server') {\n            debug('starting edge-server compiler');\n            const start = Date.now();\n            [edgeServerResult, inputFileSystem] = edgeConfig ? await (0, _compiler.runCompiler)(edgeConfig, {\n                runWebpackSpan,\n                inputFileSystem\n            }) : [\n                null\n            ];\n            debug(`edge-server compiler finished ${Date.now() - start}ms`);\n        }\n        // Only continue if there were no errors\n        if (!(serverResult == null ? void 0 : serverResult.errors.length) && !(edgeServerResult == null ? void 0 : edgeServerResult.errors.length)) {\n            const pluginState = (0, _buildcontext.getPluginState)();\n            for(const key in pluginState.injectedClientEntries){\n                const value = pluginState.injectedClientEntries[key];\n                const clientEntry = clientConfig.entry;\n                if (key === _constants.APP_CLIENT_INTERNALS) {\n                    clientEntry[_constants.CLIENT_STATIC_FILES_RUNTIME_MAIN_APP] = {\n                        import: [\n                            // TODO-APP: cast clientEntry[CLIENT_STATIC_FILES_RUNTIME_MAIN_APP] to type EntryDescription once it's available from webpack\n                            // @ts-expect-error clientEntry['main-app'] is type EntryDescription { import: ... }\n                            ...clientEntry[_constants.CLIENT_STATIC_FILES_RUNTIME_MAIN_APP].import,\n                            value\n                        ],\n                        layer: _constants1.WEBPACK_LAYERS.appPagesBrowser\n                    };\n                } else {\n                    clientEntry[key] = {\n                        dependOn: [\n                            _constants.CLIENT_STATIC_FILES_RUNTIME_MAIN_APP\n                        ],\n                        import: value,\n                        layer: _constants1.WEBPACK_LAYERS.appPagesBrowser\n                    };\n                }\n            }\n            if (!compilerName || compilerName === 'client') {\n                debug('starting client compiler');\n                const start = Date.now();\n                [clientResult, inputFileSystem] = await (0, _compiler.runCompiler)(clientConfig, {\n                    runWebpackSpan,\n                    inputFileSystem\n                });\n                debug(`client compiler finished ${Date.now() - start}ms`);\n            }\n        }\n        if (config.experimental.webpackMemoryOptimizations) {\n            _webpacksources3.stringBufferUtils.exitStringInterningRange();\n        }\n        inputFileSystem == null ? void 0 : (_inputFileSystem_purge = inputFileSystem.purge) == null ? void 0 : _inputFileSystem_purge.call(inputFileSystem);\n        result = {\n            warnings: [\n                ...(clientResult == null ? void 0 : clientResult.warnings) ?? [],\n                ...(serverResult == null ? void 0 : serverResult.warnings) ?? [],\n                ...(edgeServerResult == null ? void 0 : edgeServerResult.warnings) ?? []\n            ].filter(_nonnullable.nonNullable),\n            errors: [\n                ...(clientResult == null ? void 0 : clientResult.errors) ?? [],\n                ...(serverResult == null ? void 0 : serverResult.errors) ?? [],\n                ...(edgeServerResult == null ? void 0 : edgeServerResult.errors) ?? []\n            ].filter(_nonnullable.nonNullable),\n            stats: [\n                clientResult == null ? void 0 : clientResult.stats,\n                serverResult == null ? void 0 : serverResult.stats,\n                edgeServerResult == null ? void 0 : edgeServerResult.stats\n            ]\n        };\n    });\n    result = nextBuildSpan.traceChild('format-webpack-messages').traceFn(()=>(0, _formatwebpackmessages.default)(result, true));\n    const telemetryPlugin = (_clientConfig_plugins = clientConfig.plugins) == null ? void 0 : _clientConfig_plugins.find(isTelemetryPlugin);\n    const traceEntryPointsPlugin = (_serverConfig_plugins = serverConfig.plugins) == null ? void 0 : _serverConfig_plugins.find(isTraceEntryPointsPlugin);\n    const webpackBuildEnd = process.hrtime(webpackBuildStart);\n    if (result.errors.length > 0) {\n        // Only keep the first few errors. Others are often indicative\n        // of the same problem, but confuse the reader with noise.\n        if (result.errors.length > 5) {\n            result.errors.length = 5;\n        }\n        let error = result.errors.filter(Boolean).join('\\n\\n');\n        console.error((0, _picocolors.red)('Failed to compile.\\n'));\n        if (error.indexOf('private-next-pages') > -1 && error.indexOf('does not contain a default export') > -1) {\n            const page_name_regex = /'private-next-pages\\/(?<page_name>[^']*)'/;\n            const parsed = page_name_regex.exec(error);\n            const page_name = parsed && parsed.groups && parsed.groups.page_name;\n            throw Object.defineProperty(new Error(`webpack build failed: found page without a React Component as default export in pages/${page_name}\\n\\nSee https://nextjs.org/docs/messages/page-without-valid-component for more info.`), \"__NEXT_ERROR_CODE\", {\n                value: \"E164\",\n                enumerable: false,\n                configurable: true\n            });\n        }\n        console.error(error);\n        console.error();\n        if (error.indexOf('private-next-pages') > -1 || error.indexOf('__next_polyfill__') > -1) {\n            const err = Object.defineProperty(new Error('webpack config.resolve.alias was incorrectly overridden. https://nextjs.org/docs/messages/invalid-resolve-alias'), \"__NEXT_ERROR_CODE\", {\n                value: \"E70\",\n                enumerable: false,\n                configurable: true\n            });\n            err.code = 'INVALID_RESOLVE_ALIAS';\n            throw err;\n        }\n        const err = Object.defineProperty(new Error(`Build failed because of ${process.env.NEXT_RSPACK ? 'rspack' : 'webpack'} errors`), \"__NEXT_ERROR_CODE\", {\n            value: \"E661\",\n            enumerable: false,\n            configurable: true\n        });\n        err.code = 'WEBPACK_ERRORS';\n        throw err;\n    } else {\n        const duration = webpackBuildEnd[0];\n        const durationString = (0, _durationtostring.durationToString)(duration);\n        if (result.warnings.length > 0) {\n            _log.warn(`Compiled with warnings in ${durationString}\\n`);\n            console.warn(result.warnings.filter(Boolean).join('\\n\\n'));\n            console.warn();\n        } else if (!compilerName) {\n            _log.event(`Compiled successfully in ${durationString}`);\n        }\n        return {\n            duration: webpackBuildEnd[0],\n            buildTraceContext: traceEntryPointsPlugin == null ? void 0 : traceEntryPointsPlugin.buildTraceContext,\n            pluginState: (0, _buildcontext.getPluginState)(),\n            telemetryState: {\n                usages: (telemetryPlugin == null ? void 0 : telemetryPlugin.usages()) || [],\n                packagesUsedInServerSideProps: (telemetryPlugin == null ? void 0 : telemetryPlugin.packagesUsedInServerSideProps()) || [],\n                useCacheTracker: (telemetryPlugin == null ? void 0 : telemetryPlugin.getUseCacheTracker()) || {}\n            }\n        };\n    }\n}\nasync function workerMain(workerData) {\n    // Clone the telemetry for worker\n    const telemetry = new _storage.Telemetry({\n        distDir: workerData.buildContext.config.distDir\n    });\n    (0, _trace.setGlobal)('telemetry', telemetry);\n    // setup new build context from the serialized data passed from the parent\n    Object.assign(_buildcontext.NextBuildContext, workerData.buildContext);\n    // Initialize tracer state from the parent\n    (0, _trace.initializeTraceState)(workerData.traceState);\n    // Resume plugin state\n    (0, _buildcontext.resumePluginState)(_buildcontext.NextBuildContext.pluginState);\n    /// load the config because it's not serializable\n    _buildcontext.NextBuildContext.config = await (0, _config.default)(_constants.PHASE_PRODUCTION_BUILD, _buildcontext.NextBuildContext.dir);\n    _buildcontext.NextBuildContext.nextBuildSpan = (0, _trace.trace)(`worker-main-${workerData.compilerName}`);\n    const result = await webpackBuildImpl(workerData.compilerName);\n    const { entriesTrace, chunksTrace } = result.buildTraceContext ?? {};\n    if (entriesTrace) {\n        const { entryNameMap, depModArray } = entriesTrace;\n        if (depModArray) {\n            result.buildTraceContext.entriesTrace.depModArray = depModArray;\n        }\n        if (entryNameMap) {\n            const entryEntries = entryNameMap;\n            result.buildTraceContext.entriesTrace.entryNameMap = entryEntries;\n        }\n    }\n    if (chunksTrace == null ? void 0 : chunksTrace.entryNameFilesMap) {\n        const entryNameFilesMap = chunksTrace.entryNameFilesMap;\n        result.buildTraceContext.chunksTrace.entryNameFilesMap = entryNameFilesMap;\n    }\n    _buildcontext.NextBuildContext.nextBuildSpan.stop();\n    return {\n        ...result,\n        debugTraceEvents: (0, _trace.getTraceEvents)()\n    };\n}\n\n//# sourceMappingURL=impl.js.map"
        }
    ]
}